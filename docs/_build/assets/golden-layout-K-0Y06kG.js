import{n as nt,l as Ye,p as B,t as V,B as X,v as Y,r as Ne,I as it,c as ve,m as mt,S as ot,z as pt,J as qe,P as ft}from"./web-CZ3DQZL7.js";/* empty css                */import{u as Je}from"./SJXContext-CmP8xBfQ.js";/* empty css              */var _t=V("<button class=increment type=button>Clicks: <!$><!/>");function Ke(){const[r,e]=Ye(0),t=Je();return(()=>{var n=B(_t),i=n.firstChild,o=i.nextSibling,[s,a]=X(o.nextSibling);return n.$$click=()=>{e(r()+1),t?.ctx.increments.set(r())},Y(n,r,s,a),Ne(),n})()}nt(["click"]);class Oe extends Error{constructor(e,t){super(t),this.type=e}}class de extends Oe{constructor(e,t){super("Configuration",e),this.node=t}}class gt extends Oe{constructor(e){super("PopoutBlocked",e)}}class Ct extends Oe{constructor(e){super("API",e)}}class te extends Oe{constructor(e){super("Bind",e)}}class $e extends Error{constructor(e,t,n){super(`${e}: ${t}${n===void 0?"":": "+n}`)}}class S extends $e{constructor(e,t){super("Assert",e,t)}}class $ extends $e{constructor(e,t,n){super("UnreachableCase",e,`${t}${n===void 0?"":": "+n}`)}}class L extends $e{constructor(e,t){super("UnexpectedNull",e,t)}}class v extends $e{constructor(e,t){super("UnexpectedUndefined",e,t)}}var Ve;(function(r){let e=!1;const t={PopoutCannotBeCreatedWithGroundItemConfig:{id:0,default:"Popout cannot be created with ground ItemConfig"},PleaseRegisterAConstructorFunction:{id:1,default:"Please register a constructor function"},ComponentTypeNotRegisteredAndBindComponentEventHandlerNotAssigned:{id:2,default:"Component type not registered and BindComponentEvent handler not assigned"},ComponentIsAlreadyRegistered:{id:3,default:"Component is already registered"},ComponentIsNotVirtuable:{id:4,default:"Component is not virtuable. Requires rootHtmlElement field/getter"},VirtualComponentDoesNotHaveRootHtmlElement:{id:5,default:'Virtual component does not have getter "rootHtmlElement"'},ItemConfigIsNotTypeComponent:{id:6,default:"ItemConfig is not of type component"},InvalidNumberPartInSizeString:{id:7,default:"Invalid number part in size string"},UnknownUnitInSizeString:{id:8,default:"Unknown unit in size string"},UnsupportedUnitInSizeString:{id:9,default:"Unsupported unit in size string"}};r.idCount=Object.keys(t).length;const n=Object.values(t);function i(){if(!e)for(let o=0;o<r.idCount;o++){const s=n[o];if(s.id!==o)throw new S("INSI00110",`${o}: ${s.id}`);D[o]=s.default}e=!0}r.checkInitialise=i})(Ve||(Ve={}));const D=new Array(Ve.idCount);var Le;(function(r){r.defaultComponentBaseZIndex="auto",r.defaultComponentDragZIndex="32",r.defaultComponentStackMaximisedZIndex="41"})(Le||(Le={}));var Fe;(function(r){r.width="width",r.height="height"})(Fe||(Fe={}));var oe;(function(r){r.top="top",r.left="left",r.right="right",r.bottom="bottom"})(oe||(oe={}));var Te;(function(r){r.base="base",r.drag="drag",r.stackMaximised="stackMaximised"})(Te||(Te={}));const yt={base:Le.defaultComponentBaseZIndex,drag:Le.defaultComponentDragZIndex,stackMaximised:Le.defaultComponentStackMaximisedZIndex};var je;(function(r){function e(n){return t(n)}r.isJson=e;function t(n){return!Array.isArray(n)&&n!==null&&typeof n=="object"}r.isJsonObject=t})(je||(je={}));var p;(function(r){r.ground="ground",r.row="row",r.column="column",r.stack="stack",r.component="component"})(p||(p={}));var Re;(function(r){r.none="none",r.always="always",r.onload="onload"})(Re||(Re={}));var E;(function(r){r.Pixel="px",r.Percent="%",r.Fractional="fr",r.Em="em"})(E||(E={}));(function(r){function e(n){switch(n){case r.Pixel:return r.Pixel;case r.Percent:return r.Percent;case r.Fractional:return r.Fractional;case r.Em:return r.Em;default:return}}r.tryParse=e;function t(n){switch(n){case r.Pixel:return r.Pixel;case r.Percent:return r.Percent;case r.Fractional:return r.Fractional;case r.Em:return r.Em;default:throw new $("SUEF44998",n)}}r.format=t})(E||(E={}));function I(r){return r.toString(10)+"px"}function ye(r){const e=r.replace("px","");return parseFloat(e)}function vt(r){r=r.trimStart();const e=r.length;if(e===0)return{numericPart:"",firstNonNumericCharPart:""};{let t=e,n=!1;for(let s=0;s<e;s++){const a=r[s];if(!bt(a))if(a!=="."){t=s;break}else if(n){t=s;break}else n=!0}const i=r.substring(0,t),o=r.substring(t).trim();return{numericPart:i,firstNonNumericCharPart:o}}}function bt(r){return r>="0"&&r<="9"}function wt(r){return r.offsetWidth}function W(r,e){const t=I(e);r.style.width=t}function St(r){return r.offsetHeight}function O(r,e){const t=I(e);r.style.height=t}function ne(r){return{width:r.offsetWidth,height:r.offsetHeight}}function ie(r,e){e?r.style.display="":r.style.display="none"}function It(r){const e="absolute";r.style.position!==e&&(r.style.position=e)}function ae(r,e){if(e!==void 0){for(const t in e)if(e.hasOwnProperty(t)){const n=e[t],i=r[t];r[t]=be(i,n)}}return r}function be(r,e){if(typeof e!="object")return e;if(Array.isArray(e)){const t=e.length,n=new Array(t);for(let i=0;i<t;i++){const o=e[i];n[i]=be({},o)}return n}else{if(e===null)return null;{const t=e;return r===void 0?ae({},t):typeof r!="object"?ae({},t):Array.isArray(r)?ae({},t):ae(r===null?{}:r,t)}}}function Et(r,e){const t=e.indexOf(r);if(t===-1)throw new Error("Can't remove item from array. Item is not in the array");e.splice(t,1)}function st(){return(Math.random()*1e15).toString(36).replace(".","")}function xt(r){return r instanceof Error?r.message:typeof r=="string"?r:"Unknown Error"}var ze;(function(r){const e=["settings","hasHeaders","constrainDragToContainer","selectionEnabled","dimensions","borderWidth","minItemHeight","minItemWidth","headerHeight","dragProxyWidth","dragProxyHeight","labels","close","maximise","minimise","popout","content","componentType","componentState","id","width","type","height","isClosable","title","popoutWholeStack","openPopouts","parentId","activeItemIndex","reorderEnabled","borderGrabWidth"],t=[!0,!1,"row","column","stack","component","close","maximise","minimise","open in new window"];function n(){if(e.length>36)throw new Error("Too many keys in config minifier map")}r.checkInitialise=n;function i(h,f){const g={};for(const y in h)if(h.hasOwnProperty(y)){let b;f?b=a(y):b=l(y);const x=h[y];g[b]=s(x,f)}return g}r.translateObject=i;function o(h,f){const g=h.length,y=new Array(g);for(let b=0;b<g;b++){const x=h[b];y[b]=s(x,f)}return y}function s(h,f){return typeof h=="object"?h===null?null:Array.isArray(h)?o(h,f):i(h,f):f?d(h):c(h)}function a(h){if(typeof h=="string"&&h.length===1)return"___"+h;const f=u(h);return f===-1?h:f.toString(36)}function l(h){return h.length===1?e[parseInt(h,36)]:h.substr(0,3)==="___"?h[3]:h}function d(h){if(typeof h=="string"&&h.length===1)return"___"+h;const f=m(h);return f===-1?h:f.toString(36)}function c(h){return typeof h=="string"&&h.length===1?t[parseInt(h,36)]:typeof h=="string"&&h.substr(0,3)==="___"?h[3]:h}function u(h){for(let f=0;f<e.length;f++)if(e[f]===h)return f;return-1}function m(h){for(let f=0;f<t.length;f++)if(t[f]===h)return f;return-1}})(ze||(ze={}));var w;(function(r){r.defaults={type:p.ground,content:[],size:1,sizeUnit:E.Fractional,minSize:void 0,minSizeUnit:E.Pixel,id:"",isClosable:!0};function e(s,a){switch(s.type){case p.ground:case p.row:case p.column:return we.createCopy(s,a);case p.stack:return K.createCopy(s,a);case p.component:return Q.createCopy(s);default:throw new $("CICC91354",s.type,"Invalid Config Item type specified")}}r.createCopy=e;function t(s){switch(s){case p.ground:throw new S("CICCDR91562");case p.row:case p.column:return we.createDefault(s);case p.stack:return K.createDefault();case p.component:return Q.createDefault();default:throw new $("CICCDD91563",s,"Invalid Config Item type specified")}}r.createDefault=t;function n(s){return s.type===p.component}r.isComponentItem=n;function i(s){return s.type===p.stack}r.isStackItem=i;function o(s){return s.type===p.ground}r.isGroundItem=o})(w||(w={}));var G;(function(r){r.defaultMaximised=!1,function(e){function t(n,i){if(n!==void 0)return{show:i??n.show,popout:n.popout,close:n.close,maximise:n.maximise,minimise:n.minimise,tabDropdown:n.tabDropdown}}e.createCopy=t}(r.Header||(r.Header={}))})(G||(G={}));var K;(function(r){r.defaultActiveItemIndex=0;function e(i,o){return{type:i.type,content:t(o!==void 0?o:i.content),size:i.size,sizeUnit:i.sizeUnit,minSize:i.minSize,minSizeUnit:i.minSizeUnit,id:i.id,maximised:i.maximised,isClosable:i.isClosable,activeItemIndex:i.activeItemIndex,header:G.Header.createCopy(i.header)}}r.createCopy=e;function t(i){const o=i.length,s=new Array(o);for(let a=0;a<o;a++)s[a]=w.createCopy(i[a]);return s}r.copyContent=t;function n(){return{type:p.stack,content:[],size:w.defaults.size,sizeUnit:w.defaults.sizeUnit,minSize:w.defaults.minSize,minSizeUnit:w.defaults.minSizeUnit,id:w.defaults.id,maximised:G.defaultMaximised,isClosable:w.defaults.isClosable,activeItemIndex:r.defaultActiveItemIndex,header:void 0}}r.createDefault=n})(K||(K={}));var Q;(function(r){r.defaultReorderEnabled=!0;function e(o){const s=o.componentType;if(typeof s=="string")return s}r.resolveComponentTypeName=e;function t(o){return{type:o.type,content:[],size:o.size,sizeUnit:o.sizeUnit,minSize:o.minSize,minSizeUnit:o.minSizeUnit,id:o.id,maximised:o.maximised,isClosable:o.isClosable,reorderEnabled:o.reorderEnabled,title:o.title,header:G.Header.createCopy(o.header),componentType:o.componentType,componentState:be(void 0,o.componentState)}}r.createCopy=t;function n(o="",s,a=""){return{type:p.component,content:[],size:w.defaults.size,sizeUnit:w.defaults.sizeUnit,minSize:w.defaults.minSize,minSizeUnit:w.defaults.minSizeUnit,id:w.defaults.id,maximised:G.defaultMaximised,isClosable:w.defaults.isClosable,reorderEnabled:r.defaultReorderEnabled,title:a,header:void 0,componentType:o,componentState:s}}r.createDefault=n;function i(o){return be({},o)}r.copyComponentType=i})(Q||(Q={}));var we;(function(r){function e(o){switch(o.type){case p.row:case p.column:case p.stack:case p.component:return!0;case p.ground:return!1;default:throw new $("CROCOSPCICIC13687",o.type)}}r.isChildItemConfig=e;function t(o,s){return{type:o.type,content:n(s!==void 0?s:o.content),size:o.size,sizeUnit:o.sizeUnit,minSize:o.minSize,minSizeUnit:o.minSizeUnit,id:o.id,isClosable:o.isClosable}}r.createCopy=t;function n(o){const s=o.length,a=new Array(s);for(let l=0;l<s;l++)a[l]=w.createCopy(o[l]);return a}r.copyContent=n;function i(o){return{type:o,content:[],size:w.defaults.size,sizeUnit:w.defaults.sizeUnit,minSize:w.defaults.minSize,minSizeUnit:w.defaults.minSizeUnit,id:w.defaults.id,isClosable:w.defaults.isClosable}}r.createDefault=i})(we||(we={}));var ue;(function(r){function e(n){return w.createCopy(n)}r.createCopy=e;function t(n){switch(n.type){case p.row:case p.column:case p.stack:case p.component:return!0;case p.ground:return!1;default:throw new $("CROCOSPCICIC13687",n.type)}}r.isRootItemConfig=t})(ue||(ue={}));var Xe;(function(r){function e(t){const n=t===void 0?[]:[t];return{type:p.ground,content:n,size:100,sizeUnit:E.Percent,minSize:0,minSizeUnit:E.Pixel,id:"",isClosable:!1,title:"",reorderEnabled:!1}}r.create=e})(Xe||(Xe={}));var C;(function(r){(function(a){a.defaults={constrainDragToContainer:!0,reorderEnabled:!0,popoutWholeStack:!1,blockedPopoutsThrowError:!0,closePopoutsOnUnload:!0,responsiveMode:Re.none,tabOverlapAllowance:0,reorderOnTabMenuClick:!0,tabControlOffset:10,popInOnClose:!1};function l(d){return{constrainDragToContainer:d.constrainDragToContainer,reorderEnabled:d.reorderEnabled,popoutWholeStack:d.popoutWholeStack,blockedPopoutsThrowError:d.blockedPopoutsThrowError,closePopoutsOnUnload:d.closePopoutsOnUnload,responsiveMode:d.responsiveMode,tabOverlapAllowance:d.tabOverlapAllowance,reorderOnTabMenuClick:d.reorderOnTabMenuClick,tabControlOffset:d.tabControlOffset,popInOnClose:d.popInOnClose}}a.createCopy=l})(r.Settings||(r.Settings={})),function(a){function l(d){return{borderWidth:d.borderWidth,borderGrabWidth:d.borderGrabWidth,defaultMinItemHeight:d.defaultMinItemHeight,defaultMinItemHeightUnit:d.defaultMinItemHeightUnit,defaultMinItemWidth:d.defaultMinItemWidth,defaultMinItemWidthUnit:d.defaultMinItemWidthUnit,headerHeight:d.headerHeight,dragProxyWidth:d.dragProxyWidth,dragProxyHeight:d.dragProxyHeight}}a.createCopy=l,a.defaults={borderWidth:5,borderGrabWidth:5,defaultMinItemHeight:0,defaultMinItemHeightUnit:E.Pixel,defaultMinItemWidth:10,defaultMinItemWidthUnit:E.Pixel,headerHeight:20,dragProxyWidth:300,dragProxyHeight:200}}(r.Dimensions||(r.Dimensions={})),function(a){function l(d){return{show:d.show,popout:d.popout,dock:d.dock,close:d.close,maximise:d.maximise,minimise:d.minimise,tabDropdown:d.tabDropdown}}a.createCopy=l,a.defaults={show:oe.top,popout:"open in new window",dock:"dock",maximise:"maximise",minimise:"minimise",close:"close",tabDropdown:"additional tabs"}}(r.Header||(r.Header={}));function e(a){return"parentId"in a}r.isPopout=e;function t(){return{root:void 0,openPopouts:[],dimensions:r.Dimensions.defaults,settings:r.Settings.defaults,header:r.Header.defaults,resolved:!0}}r.createDefault=t;function n(a){return e(a)?Me.createCopy(a):{root:a.root===void 0?void 0:ue.createCopy(a.root),openPopouts:r.copyOpenPopouts(a.openPopouts),settings:r.Settings.createCopy(a.settings),dimensions:r.Dimensions.createCopy(a.dimensions),header:r.Header.createCopy(a.header),resolved:a.resolved}}r.createCopy=n;function i(a){const l=a.length,d=new Array(l);for(let c=0;c<l;c++)d[c]=Me.createCopy(a[c]);return d}r.copyOpenPopouts=i;function o(a){return ze.translateObject(a,!0)}r.minifyConfig=o;function s(a){return ze.translateObject(a,!1)}r.unminifyConfig=s})(C||(C={}));var Me;(function(r){(function(t){function n(i){return{width:i.width,height:i.height,left:i.left,top:i.top}}t.createCopy=n,t.defaults={width:null,height:null,left:null,top:null}})(r.Window||(r.Window={}));function e(t){return{root:t.root===void 0?void 0:ue.createCopy(t.root),openPopouts:C.copyOpenPopouts(t.openPopouts),settings:C.Settings.createCopy(t.settings),dimensions:C.Dimensions.createCopy(t.dimensions),header:C.Header.createCopy(t.header),parentId:t.parentId,indexInParent:t.indexInParent,window:r.Window.createCopy(t.window),resolved:t.resolved}}r.createCopy=e})(Me||(Me={}));var R;(function(r){function e(m,h){switch(m.type){case p.ground:throw new de("ItemConfig cannot specify type ground",JSON.stringify(m));case p.row:case p.column:return Ue.resolve(m,h);case p.stack:return Ae.resolve(m,h);case p.component:return se.resolve(m,h);default:throw new $("UCUICR55499",m.type)}}r.resolve=e;function t(m){if(m===void 0)return[];{const h=m.length,f=new Array(h);for(let g=0;g<h;g++)f[g]=r.resolve(m[g],!1);return f}}r.resolveContent=t;function n(m){return m===void 0?w.defaults.id:Array.isArray(m)?m.length===0?w.defaults.id:m[0]:m}r.resolveId=n;function i(m,h,f,g){if(m!==void 0)return We(m,[E.Percent,E.Fractional]);if(h!==void 0||f!==void 0){if(h!==void 0)return{size:h,sizeUnit:E.Percent};if(f!==void 0)return{size:f,sizeUnit:E.Percent};throw new v("CRS33390")}else return g?{size:50,sizeUnit:E.Percent}:{size:w.defaults.size,sizeUnit:w.defaults.sizeUnit}}r.resolveSize=i;function o(m,h,f){if(m!==void 0)return We(m,[E.Pixel]);{const g=h!==void 0;return g||f!==void 0?g?{size:h,sizeUnit:E.Pixel}:{size:f,sizeUnit:E.Pixel}:{size:w.defaults.minSize,sizeUnit:w.defaults.minSizeUnit}}}r.resolveMinSize=o;function s(m){return m.size!==void 0?1:m.width!==void 0||m.height!==void 0?2:0}r.calculateSizeWidthHeightSpecificationType=s;function a(m){return m.type===p.ground}r.isGround=a;function l(m){return m.type===p.row}r.isRow=l;function d(m){return m.type===p.column}r.isColumn=d;function c(m){return m.type===p.stack}r.isStack=c;function u(m){return m.type===p.component}r.isComponent=u})(R||(R={}));var Se;(function(r){const e="__glMaximised";(function(n){function i(o,s){var a;if(!(o===void 0&&s===void 0))return{show:(a=o?.show)!==null&&a!==void 0?a:s===void 0?void 0:s?C.Header.defaults.show:!1,popout:o?.popout,maximise:o?.maximise,close:o?.close,minimise:o?.minimise,tabDropdown:o?.tabDropdown}}n.resolve=i})(r.Header||(r.Header={}));function t(n){let i,o=n.id,s=!1;if(o===void 0)i=w.defaults.id;else if(Array.isArray(o)){const l=o.findIndex(d=>d===e);l>0&&(s=!0,o=o.splice(l,1)),o.length>0?i=o[0]:i=w.defaults.id}else i=o;let a;return n.maximised!==void 0?a=n.maximised:a=s,{id:i,maximised:a}}r.resolveIdAndMaximised=t})(Se||(Se={}));var Ae;(function(r){function e(o,s){var a,l;const{id:d,maximised:c}=Se.resolveIdAndMaximised(o),{size:u,sizeUnit:m}=R.resolveSize(o.size,o.width,o.height,s),{size:h,sizeUnit:f}=R.resolveMinSize(o.minSize,o.minWidth,o.minHeight);return{type:p.stack,content:n(o.content),size:u,sizeUnit:m,minSize:h,minSizeUnit:f,id:d,maximised:c,isClosable:(a=o.isClosable)!==null&&a!==void 0?a:w.defaults.isClosable,activeItemIndex:(l=o.activeItemIndex)!==null&&l!==void 0?l:K.defaultActiveItemIndex,header:Se.Header.resolve(o.header,o.hasHeaders)}}r.resolve=e;function t(o){return{type:p.stack,content:i(o.content),size:Pe(o.size,o.sizeUnit),minSize:Qe(o.minSize,o.minSizeUnit),id:o.id,maximised:o.maximised,isClosable:o.isClosable,activeItemIndex:o.activeItemIndex,header:G.Header.createCopy(o.header)}}r.fromResolved=t;function n(o){if(o===void 0)return[];{const s=o.length,a=new Array(s);for(let l=0;l<s;l++){const d=o[l],c=R.resolve(d,!1);if(w.isComponentItem(c))a[l]=c;else throw new S("UCUSICRC91114",JSON.stringify(c))}return a}}function i(o){const s=o.length,a=new Array(s);for(let l=0;l<s;l++){const d=o[l];a[l]=se.fromResolved(d)}return a}})(Ae||(Ae={}));var se;(function(r){function e(i,o){var s,a,l;let d=i.componentType;if(d===void 0&&(d=i.componentName),d===void 0)throw new Error("ComponentItemConfig.componentType is undefined");{const{id:c,maximised:u}=Se.resolveIdAndMaximised(i);let m;i.title===void 0||i.title===""?m=r.componentTypeToTitle(d):m=i.title;const{size:h,sizeUnit:f}=R.resolveSize(i.size,i.width,i.height,o),{size:g,sizeUnit:y}=R.resolveMinSize(i.minSize,i.minWidth,i.minHeight);return{type:i.type,content:[],size:h,sizeUnit:f,minSize:g,minSizeUnit:y,id:c,maximised:u,isClosable:(s=i.isClosable)!==null&&s!==void 0?s:w.defaults.isClosable,reorderEnabled:(a=i.reorderEnabled)!==null&&a!==void 0?a:Q.defaultReorderEnabled,title:m,header:Se.Header.resolve(i.header,i.hasHeaders),componentType:d,componentState:(l=i.componentState)!==null&&l!==void 0?l:{}}}}r.resolve=e;function t(i){return{type:p.component,size:Pe(i.size,i.sizeUnit),minSize:Qe(i.minSize,i.minSizeUnit),id:i.id,maximised:i.maximised,isClosable:i.isClosable,reorderEnabled:i.reorderEnabled,title:i.title,header:G.Header.createCopy(i.header),componentType:i.componentType,componentState:be(void 0,i.componentState)}}r.fromResolved=t;function n(i){switch(typeof i){case"string":return i;case"number":return i.toString();case"boolean":return i.toString();default:return""}}r.componentTypeToTitle=n})(se||(se={}));var Ue;(function(r){function e(s){switch(s.type){case p.row:case p.column:case p.stack:case p.component:return!0;case p.ground:return!1;default:throw new $("UROCOSPCICIC13687",s.type)}}r.isChildItemConfig=e;function t(s,a){var l;const{size:d,sizeUnit:c}=R.resolveSize(s.size,s.width,s.height,a),{size:u,sizeUnit:m}=R.resolveMinSize(s.minSize,s.minWidth,s.minHeight);return{type:s.type,content:r.resolveContent(s.content),size:d,sizeUnit:c,minSize:u,minSizeUnit:m,id:R.resolveId(s.id),isClosable:(l=s.isClosable)!==null&&l!==void 0?l:w.defaults.isClosable}}r.resolve=t;function n(s){return{type:s.type,content:o(s.content),size:Pe(s.size,s.sizeUnit),minSize:Qe(s.minSize,s.minSizeUnit),id:s.id,isClosable:s.isClosable}}r.fromResolved=n;function i(s){if(s===void 0)return[];{const a=s.length,l=new Array(a);let d=!1,c=!1;for(let h=0;h<a;h++){const f=s[h];if(r.isChildItemConfig(f)){if(!c){const g=R.calculateSizeWidthHeightSpecificationType(f);switch(g){case 0:break;case 2:d=!0;break;case 1:c=!0;break;default:throw new $("ROCICRC87556",g)}}l[h]=f}else throw new de("ItemConfig is not Row, Column or Stack",f)}let u;c?u=!1:d?u=!0:u=!1;const m=new Array(a);for(let h=0;h<a;h++){const f=l[h],g=R.resolve(f,u);if(we.isChildItemConfig(g))m[h]=g;else throw new S("UROCOSPIC99512",JSON.stringify(g))}return m}}r.resolveContent=i;function o(s){const a=s.length,l=new Array(a);for(let d=0;d<a;d++){const c=s[d],u=c.type;let m;switch(u){case p.row:case p.column:m=r.fromResolved(c);break;case p.stack:m=Ae.fromResolved(c);break;case p.component:m=se.fromResolved(c);break;default:throw new $("ROCICFRC44797",u)}l[d]=m}return l}})(Ue||(Ue={}));var Ie;(function(r){function e(i){switch(i.type){case p.row:case p.column:case p.stack:case p.component:return!0;case p.ground:return!1;default:throw new $("URICIR23687",i.type)}}r.isRootItemConfig=e;function t(i){if(i!==void 0){const o=R.resolve(i,!1);if(ue.isRootItemConfig(o))return o;throw new de("ItemConfig is not Row, Column or Stack",JSON.stringify(i))}}r.resolve=t;function n(i){if(i!==void 0){const o=i.type;switch(o){case p.row:case p.column:return Ue.fromResolved(i);case p.stack:return Ae.fromResolved(i);case p.component:return se.fromResolved(i);default:throw new $("RICFROU89921",o)}}}r.fromResolvedOrUndefined=n})(Ie||(Ie={}));var U;(function(r){(function(s){function a(l){var d,c,u,m,h,f,g,y,b,x;return{constrainDragToContainer:(d=l?.constrainDragToContainer)!==null&&d!==void 0?d:C.Settings.defaults.constrainDragToContainer,reorderEnabled:(c=l?.reorderEnabled)!==null&&c!==void 0?c:C.Settings.defaults.reorderEnabled,popoutWholeStack:(u=l?.popoutWholeStack)!==null&&u!==void 0?u:C.Settings.defaults.popoutWholeStack,blockedPopoutsThrowError:(m=l?.blockedPopoutsThrowError)!==null&&m!==void 0?m:C.Settings.defaults.blockedPopoutsThrowError,closePopoutsOnUnload:(h=l?.closePopoutsOnUnload)!==null&&h!==void 0?h:C.Settings.defaults.closePopoutsOnUnload,responsiveMode:(f=l?.responsiveMode)!==null&&f!==void 0?f:C.Settings.defaults.responsiveMode,tabOverlapAllowance:(g=l?.tabOverlapAllowance)!==null&&g!==void 0?g:C.Settings.defaults.tabOverlapAllowance,reorderOnTabMenuClick:(y=l?.reorderOnTabMenuClick)!==null&&y!==void 0?y:C.Settings.defaults.reorderOnTabMenuClick,tabControlOffset:(b=l?.tabControlOffset)!==null&&b!==void 0?b:C.Settings.defaults.tabControlOffset,popInOnClose:(x=l?.popInOnClose)!==null&&x!==void 0?x:C.Settings.defaults.popInOnClose}}s.resolve=a})(r.Settings||(r.Settings={})),function(s){function a(u){var m,h,f,g,y;const{size:b,sizeUnit:x}=s.resolveDefaultMinItemHeight(u),{size:A,sizeUnit:P}=s.resolveDefaultMinItemWidth(u);return{borderWidth:(m=u?.borderWidth)!==null&&m!==void 0?m:C.Dimensions.defaults.borderWidth,borderGrabWidth:(h=u?.borderGrabWidth)!==null&&h!==void 0?h:C.Dimensions.defaults.borderGrabWidth,defaultMinItemHeight:b,defaultMinItemHeightUnit:x,defaultMinItemWidth:A,defaultMinItemWidthUnit:P,headerHeight:(f=u?.headerHeight)!==null&&f!==void 0?f:C.Dimensions.defaults.headerHeight,dragProxyWidth:(g=u?.dragProxyWidth)!==null&&g!==void 0?g:C.Dimensions.defaults.dragProxyWidth,dragProxyHeight:(y=u?.dragProxyHeight)!==null&&y!==void 0?y:C.Dimensions.defaults.dragProxyHeight}}s.resolve=a;function l(u){return{borderWidth:u.borderWidth,borderGrabWidth:u.borderGrabWidth,defaultMinItemHeight:Pe(u.defaultMinItemHeight,u.defaultMinItemHeightUnit),defaultMinItemWidth:Pe(u.defaultMinItemWidth,u.defaultMinItemWidthUnit),headerHeight:u.headerHeight,dragProxyWidth:u.dragProxyWidth,dragProxyHeight:u.dragProxyHeight}}s.fromResolved=l;function d(u){const m=u?.defaultMinItemHeight;return m===void 0?{size:C.Dimensions.defaults.defaultMinItemHeight,sizeUnit:C.Dimensions.defaults.defaultMinItemHeightUnit}:We(m,[E.Pixel])}s.resolveDefaultMinItemHeight=d;function c(u){const m=u?.defaultMinItemWidth;return m===void 0?{size:C.Dimensions.defaults.defaultMinItemWidth,sizeUnit:C.Dimensions.defaults.defaultMinItemWidthUnit}:We(m,[E.Pixel])}s.resolveDefaultMinItemWidth=c}(r.Dimensions||(r.Dimensions={})),function(s){function a(l,d,c){var u,m,h,f,g,y,b,x,A,P,k,F;let M;return l?.show!==void 0?M=l.show:d!==void 0&&d.hasHeaders!==void 0?M=d.hasHeaders?C.Header.defaults.show:!1:M=C.Header.defaults.show,{show:M,popout:(m=(u=l?.popout)!==null&&u!==void 0?u:c?.popout)!==null&&m!==void 0?m:d?.showPopoutIcon===!1?!1:C.Header.defaults.popout,dock:(f=(h=l?.popin)!==null&&h!==void 0?h:c?.popin)!==null&&f!==void 0?f:C.Header.defaults.dock,maximise:(y=(g=l?.maximise)!==null&&g!==void 0?g:c?.maximise)!==null&&y!==void 0?y:d?.showMaximiseIcon===!1?!1:C.Header.defaults.maximise,close:(x=(b=l?.close)!==null&&b!==void 0?b:c?.close)!==null&&x!==void 0?x:d?.showCloseIcon===!1?!1:C.Header.defaults.close,minimise:(P=(A=l?.minimise)!==null&&A!==void 0?A:c?.minimise)!==null&&P!==void 0?P:C.Header.defaults.minimise,tabDropdown:(F=(k=l?.tabDropdown)!==null&&k!==void 0?k:c?.tabDropdown)!==null&&F!==void 0?F:C.Header.defaults.tabDropdown}}s.resolve=a}(r.Header||(r.Header={}));function e(s){return"parentId"in s||"indexInParent"in s||"window"in s}r.isPopout=e;function t(s){if(e(s))return ke.resolve(s);{let a;return s.root!==void 0?a=s.root:s.content!==void 0&&s.content.length>0?a=s.content[0]:a=void 0,{resolved:!0,root:Ie.resolve(a),openPopouts:r.resolveOpenPopouts(s.openPopouts),dimensions:r.Dimensions.resolve(s.dimensions),settings:r.Settings.resolve(s.settings),header:r.Header.resolve(s.header,s.settings,s.labels)}}}r.resolve=t;function n(s){return{root:Ie.fromResolvedOrUndefined(s.root),openPopouts:ke.fromResolvedArray(s.openPopouts),settings:C.Settings.createCopy(s.settings),dimensions:r.Dimensions.fromResolved(s.dimensions),header:C.Header.createCopy(s.header)}}r.fromResolved=n;function i(s){const a=s;return a.resolved!==void 0&&a.resolved===!0}r.isResolved=i;function o(s){if(s===void 0)return[];{const a=s.length,l=new Array(a);for(let d=0;d<a;d++)l[d]=ke.resolve(s[d]);return l}}r.resolveOpenPopouts=o})(U||(U={}));var ke;(function(r){(function(i){function o(a,l){var d,c,u,m,h,f,g,y;let b;const x=Me.Window.defaults;return a!==void 0?b={width:(d=a.width)!==null&&d!==void 0?d:x.width,height:(c=a.height)!==null&&c!==void 0?c:x.height,left:(u=a.left)!==null&&u!==void 0?u:x.left,top:(m=a.top)!==null&&m!==void 0?m:x.top}:b={width:(h=l?.width)!==null&&h!==void 0?h:x.width,height:(f=l?.height)!==null&&f!==void 0?f:x.height,left:(g=l?.left)!==null&&g!==void 0?g:x.left,top:(y=l?.top)!==null&&y!==void 0?y:x.top},b}i.resolve=o;function s(a){return{width:a.width===null?void 0:a.width,height:a.height===null?void 0:a.height,left:a.left===null?void 0:a.left,top:a.top===null?void 0:a.top}}i.fromResolved=s})(r.Window||(r.Window={}));function e(i){var o,s;let a;return i.root!==void 0?a=i.root:i.content!==void 0&&i.content.length>0?a=i.content[0]:a=void 0,{root:Ie.resolve(a),openPopouts:U.resolveOpenPopouts(i.openPopouts),dimensions:U.Dimensions.resolve(i.dimensions),settings:U.Settings.resolve(i.settings),header:U.Header.resolve(i.header,i.settings,i.labels),parentId:(o=i.parentId)!==null&&o!==void 0?o:null,indexInParent:(s=i.indexInParent)!==null&&s!==void 0?s:null,window:r.Window.resolve(i.window,i.dimensions),resolved:!0}}r.resolve=e;function t(i){return{root:Ie.fromResolvedOrUndefined(i.root),openPopouts:n(i.openPopouts),dimensions:U.Dimensions.fromResolved(i.dimensions),settings:C.Settings.createCopy(i.settings),header:C.Header.createCopy(i.header),parentId:i.parentId,indexInParent:i.indexInParent,window:r.Window.fromResolved(i.window)}}r.fromResolved=t;function n(i){const o=i.length,s=new Array(o);for(let a=0;a<o;a++){const l=i[a];s[a]=r.fromResolved(l)}return s}r.fromResolvedArray=n})(ke||(ke={}));function We(r,e){const{numericPart:t,firstNonNumericCharPart:n}=vt(r),i=Number.parseInt(t,10);if(isNaN(i))throw new de(`${D[7]}: ${r}`);{const o=E.tryParse(n);if(o===void 0)throw new de(`${D[8]}: ${r}`);if(e.includes(o))return{size:i,sizeUnit:o};throw new de(`${D[9]}: ${r}`)}}function Pe(r,e){return r.toString(10)+E.format(e)}function Qe(r,e){if(r!==void 0)return r.toString(10)+E.format(e)}class z{constructor(){this._allEventSubscriptions=[],this._subscriptionsMap=new Map,this.unbind=this.removeEventListener,this.trigger=this.emit}tryBubbleEvent(e,t){}emit(e,...t){let n=this._subscriptionsMap.get(e);if(n!==void 0){n=n.slice();for(let i=0;i<n.length;i++){const o=n[i];o(...t)}}this.emitAllEvent(e,t),this.tryBubbleEvent(e,t)}emitUnknown(e,...t){let n=this._subscriptionsMap.get(e);if(n!==void 0){n=n.slice();for(let i=0;i<n.length;i++)n[i](...t)}this.emitAllEvent(e,t),this.tryBubbleEvent(e,t)}emitBaseBubblingEvent(e){const t=new z.BubblingEvent(e,this);this.emitUnknown(e,t)}emitUnknownBubblingEvent(e){const t=new z.BubblingEvent(e,this);this.emitUnknown(e,t)}removeEventListener(e,t){const n=t;this.removeUnknownEventListener(e,n)}off(e,t){this.removeEventListener(e,t)}addEventListener(e,t){const n=t;this.addUnknownEventListener(e,n)}on(e,t){this.addEventListener(e,t)}addUnknownEventListener(e,t){if(e===z.ALL_EVENT)this._allEventSubscriptions.push(t);else{let n=this._subscriptionsMap.get(e);n!==void 0?n.push(t):(n=[t],this._subscriptionsMap.set(e,n))}}removeUnknownEventListener(e,t){if(e===z.ALL_EVENT)this.removeSubscription(e,this._allEventSubscriptions,t);else{const n=this._subscriptionsMap.get(e);if(n===void 0)throw new Error("No subscribtions to unsubscribe for event "+e);this.removeSubscription(e,n,t)}}removeSubscription(e,t,n){const i=t.indexOf(n);if(i<0)throw new Error("Nothing to unbind for "+e);t.splice(i,1)}emitAllEvent(e,t){const n=this._allEventSubscriptions.length;if(n>0){const i=t.slice();i.unshift(e);const o=this._allEventSubscriptions.slice();for(let s=0;s<n;s++)o[s](...i)}}}(function(r){r.ALL_EVENT="__all",r.headerClickEventName="stackHeaderClick",r.headerTouchStartEventName="stackHeaderTouchStart";class e{constructor(o,s){this._name=o,this._target=s,this._isPropagationStopped=!1}get name(){return this._name}get target(){return this._target}get origin(){return this._target}get isPropagationStopped(){return this._isPropagationStopped}stopPropagation(){this._isPropagationStopped=!0}}r.BubblingEvent=e;class t extends e{constructor(o,s,a){super(o,s),this._mouseEvent=a}get mouseEvent(){return this._mouseEvent}}r.ClickBubblingEvent=t;class n extends e{constructor(o,s,a){super(o,s),this._touchEvent=a}get touchEvent(){return this._touchEvent}}r.TouchStartBubblingEvent=n})(z||(z={}));class Lt extends z{constructor(e,t,n,i,o,s,a,l,d){super(),this._config=e,this._parent=t,this._layoutManager=n,this._element=i,this._updateItemConfigEvent=o,this._showEvent=s,this._hideEvent=a,this._focusEvent=l,this._blurEvent=d,this._stackMaximised=!1,this._width=0,this._height=0,this._visible=!0,this._isShownWithZeroDimensions=!0,this._componentType=e.componentType,this._isClosable=e.isClosable,this._initialState=e.componentState,this._state=this._initialState,this._boundComponent=this.layoutManager.bindComponent(this,e),this.updateElementPositionPropertyFromBoundComponent()}get width(){return this._width}get height(){return this._height}get parent(){return this._parent}get componentName(){return this._componentType}get componentType(){return this._componentType}get virtual(){return this._boundComponent.virtual}get component(){return this._boundComponent.component}get tab(){return this._tab}get title(){return this._parent.title}get layoutManager(){return this._layoutManager}get isHidden(){return!this._visible}get visible(){return this._visible}get state(){return this._state}get initialState(){return this._initialState}get element(){return this._element}destroy(){this.releaseComponent(),this.stateRequestEvent=void 0,this.emit("destroy")}getElement(){return this._element}hide(){this._hideEvent()}show(){this._showEvent()}focus(e=!1){this._focusEvent(e)}blur(e=!1){this._blurEvent(e)}setSize(e,t){let n=this._parent;if(n.isColumn||n.isRow||n.parent===null)throw new S("ICSSPRC","ComponentContainer cannot have RowColumn Parent");{let i;do i=n,n=n.parent;while(n!==null&&!n.isColumn&&!n.isRow);if(n===null)return!1;{const o=n.isColumn?"height":"width",s=this[o];if(s===null)throw new L("ICSSCS11194");{const a=o==="height"?t:e,l=s*(1/(i.size/100)),d=a/l*100,c=(i.size-d)/(n.contentItems.length-1);for(let u=0;u<n.contentItems.length;u++){const m=n.contentItems[u];m===i?m.size=d:m.size+=c}return n.updateSize(!1),!0}}}}close(){this._isClosable&&(this.emit("close"),this._parent.close())}replaceComponent(e){if(this.releaseComponent(),R.isComponent(e)){const t=se.resolve(e,!1);if(this._initialState=t.componentState,this._state=this._initialState,this._componentType=t.componentType,this._updateItemConfigEvent(t),this._boundComponent=this.layoutManager.bindComponent(this,t),this.updateElementPositionPropertyFromBoundComponent(),this._boundComponent.virtual){if(this.virtualVisibilityChangeRequiredEvent!==void 0&&this.virtualVisibilityChangeRequiredEvent(this,this._visible),this.virtualRectingRequiredEvent!==void 0){this._layoutManager.fireBeforeVirtualRectingEvent(1);try{this.virtualRectingRequiredEvent(this,this._width,this._height)}finally{this._layoutManager.fireAfterVirtualRectingEvent()}}this.setBaseLogicalZIndex()}this.emit("stateChanged")}else throw new Error("ReplaceComponent not passed a component ItemConfig")}getState(){return this._state}extendState(e){const t=ae(this._state,e);this.setState(t)}setState(e){this._state=e,this._parent.emitBaseBubblingEvent("stateChanged")}setTitle(e){this._parent.setTitle(e)}setTab(e){this._tab=e,this.emit("tab",e)}setVisibility(e){this._boundComponent.virtual&&this.virtualVisibilityChangeRequiredEvent!==void 0&&this.virtualVisibilityChangeRequiredEvent(this,e),e?this._visible?this._isShownWithZeroDimensions&&(this._height!==0||this._width!==0)&&(this._isShownWithZeroDimensions=!1,this.setSizeToNodeSize(this._width,this._height,!0),this.emitShow()):(this._visible=!0,this._height===0&&this._width===0?this._isShownWithZeroDimensions=!0:(this._isShownWithZeroDimensions=!1,this.setSizeToNodeSize(this._width,this._height,!0),this.emitShow())):this._visible&&(this._visible=!1,this._isShownWithZeroDimensions=!1,this.emitHide())}setBaseLogicalZIndex(){this.setLogicalZIndex(Te.base)}setLogicalZIndex(e){e!==this._logicalZIndex&&(this._logicalZIndex=e,this.notifyVirtualZIndexChangeRequired())}enterDragMode(e,t){this._width=e,this._height=t,W(this._element,e),O(this._element,t),this.setLogicalZIndex(Te.drag),this.drag()}exitDragMode(){this.setBaseLogicalZIndex()}enterStackMaximised(){this._stackMaximised=!0,this.setLogicalZIndex(Te.stackMaximised)}exitStackMaximised(){this.setBaseLogicalZIndex(),this._stackMaximised=!1}drag(){if(this._boundComponent.virtual&&this.virtualRectingRequiredEvent!==void 0){this._layoutManager.fireBeforeVirtualRectingEvent(1);try{this.virtualRectingRequiredEvent(this,this._width,this._height)}finally{this._layoutManager.fireAfterVirtualRectingEvent()}}}setSizeToNodeSize(e,t,n){(e!==this._width||t!==this._height||n)&&(this._width=e,this._height=t,W(this._element,e),O(this._element,t),this._boundComponent.virtual?this.addVirtualSizedContainerToLayoutManager():(this.emit("resize"),this.checkShownFromZeroDimensions()))}notifyVirtualRectingRequired(){this.virtualRectingRequiredEvent!==void 0&&(this.virtualRectingRequiredEvent(this,this._width,this._height),this.emit("resize"),this.checkShownFromZeroDimensions())}notifyVirtualZIndexChangeRequired(){if(this.virtualZIndexChangeRequiredEvent!==void 0){const e=this._logicalZIndex,t=yt[e];this.virtualZIndexChangeRequiredEvent(this,e,t)}}updateElementPositionPropertyFromBoundComponent(){this._boundComponent.virtual?this._element.style.position="static":this._element.style.position=""}addVirtualSizedContainerToLayoutManager(){this._layoutManager.beginVirtualSizedContainerAdding();try{this._layoutManager.addVirtualSizedContainer(this)}finally{this._layoutManager.endVirtualSizedContainerAdding()}}checkShownFromZeroDimensions(){this._isShownWithZeroDimensions&&(this._height!==0||this._width!==0)&&(this._isShownWithZeroDimensions=!1,this.emitShow())}emitShow(){this.emit("shown"),this.emit("show")}emitHide(){this.emit("hide")}releaseComponent(){this._stackMaximised&&this.exitStackMaximised(),this.emit("beforeComponentRelease",this._boundComponent.component),this.layoutManager.unbindComponent(this,this._boundComponent.virtual,this._boundComponent.component)}}class Tt extends z{constructor(e,t,n){super(),this._config=e,this._initialWindowSize=t,this._layoutManager=n,this._isInitialised=!1,this._popoutWindow=null,this.createWindow()}toConfig(){var e,t;if(this._isInitialised===!1)throw new Error("Can't create config, layout not yet initialised");const i=this.getGlInstance().saveLayout();let o,s;this._popoutWindow===null?(o=null,s=null):(o=(e=this._popoutWindow.screenX)!==null&&e!==void 0?e:this._popoutWindow.screenLeft,s=(t=this._popoutWindow.screenY)!==null&&t!==void 0?t:this._popoutWindow.screenTop);const a={width:this.getGlInstance().width,height:this.getGlInstance().height,left:o,top:s};return{root:i.root,openPopouts:i.openPopouts,settings:i.settings,dimensions:i.dimensions,header:i.header,window:a,parentId:this._config.parentId,indexInParent:this._config.indexInParent,resolved:!0}}getGlInstance(){if(this._popoutWindow===null)throw new L("BPGGI24693");return this._popoutWindow.__glInstance}getWindow(){if(this._popoutWindow===null)throw new L("BPGW087215");return this._popoutWindow}close(){if(this.getGlInstance())this.getGlInstance().closeWindow();else try{this.getWindow().close()}catch{}}popIn(){let e,t=this._config.indexInParent;if(!this._config.parentId)return;const n=this.getGlInstance().saveLayout(),o=ae({},n).root;if(o===void 0)throw new v("BPPIR19998");const s=this._layoutManager.groundItem;if(s===void 0)throw new v("BPPIG34972");e=s.getItemsByPopInParentId(this._config.parentId)[0],e||(s.contentItems.length>0?e=s.contentItems[0]:e=s,t=0);const a=this._layoutManager.createAndInitContentItem(o,e);e.addChild(a,t),this._layoutManager.layoutConfig.settings.popInOnClose?this._onClose():this.close()}createWindow(){const e=this.createUrl(),t=Math.floor(Math.random()*1e6).toString(36),n=this.serializeWindowFeatures({width:this._initialWindowSize.width,height:this._initialWindowSize.height,innerWidth:this._initialWindowSize.width,innerHeight:this._initialWindowSize.height,menubar:"no",toolbar:"no",location:"no",personalbar:"no",resizable:"yes",scrollbars:"no",status:"no"});if(this._popoutWindow=globalThis.open(e,t,n),!this._popoutWindow){if(this._layoutManager.layoutConfig.settings.blockedPopoutsThrowError===!0)throw new gt("Popout blocked");return}this._popoutWindow.addEventListener("load",()=>this.positionWindow(),{passive:!0}),this._popoutWindow.addEventListener("beforeunload",()=>{this._layoutManager.layoutConfig.settings.popInOnClose?this.popIn():this._onClose()},{passive:!0}),this._checkReadyInterval=setInterval(()=>this.checkReady(),10)}checkReady(){if(this._popoutWindow===null)throw new L("BPCR01844");this._popoutWindow.__glInstance&&this._popoutWindow.__glInstance.isInitialised&&(this.onInitialised(),this._checkReadyInterval!==void 0&&(clearInterval(this._checkReadyInterval),this._checkReadyInterval=void 0))}serializeWindowFeatures(e){const t=[];for(const n in e)t.push(n+"="+e[n].toString());return t.join(",")}createUrl(){const e="gl-window-config-"+st(),t=C.minifyConfig(this._config);try{localStorage.setItem(e,JSON.stringify(t))}catch(i){throw new Error("Error while writing to localStorage "+xt(i))}const n=new URL(location.href);return n.searchParams.set("gl-window",e),n.toString()}positionWindow(){if(this._popoutWindow===null)throw new Error("BrowserPopout.positionWindow: null popoutWindow");this._popoutWindow.moveTo(this._initialWindowSize.left,this._initialWindowSize.top),this._popoutWindow.focus()}onInitialised(){this._isInitialised=!0,this.getGlInstance().on("popIn",()=>this.popIn()),this.emit("initialised")}_onClose(){setTimeout(()=>this.emit("closed"),50)}}class N extends z{constructor(e,t,n,i){super(),this.layoutManager=e,this._parent=n,this._element=i,this._popInParentIds=[],this._type=t.type,this._id=t.id,this._isInitialised=!1,this.isGround=!1,this.isRow=!1,this.isColumn=!1,this.isStack=!1,this.isComponent=!1,this.size=t.size,this.sizeUnit=t.sizeUnit,this.minSize=t.minSize,this.minSizeUnit=t.minSizeUnit,this._isClosable=t.isClosable,this._pendingEventPropagations={},this._throttledEvents=["stateChanged"],this._contentItems=this.createContentItems(t.content)}get type(){return this._type}get id(){return this._id}set id(e){this._id=e}get popInParentIds(){return this._popInParentIds}get parent(){return this._parent}get contentItems(){return this._contentItems}get isClosable(){return this._isClosable}get element(){return this._element}get isInitialised(){return this._isInitialised}static isStack(e){return e.isStack}static isComponentItem(e){return e.isComponent}static isComponentParentableItem(e){return e.isStack||e.isGround}removeChild(e,t=!1){const n=this._contentItems.indexOf(e);if(n===-1)throw new Error("Can't remove child item. Unknown content item");if(t||this._contentItems[n].destroy(),this._contentItems.splice(n,1),this._contentItems.length>0)this.updateSize(!1);else if(!this.isGround&&this._isClosable===!0){if(this._parent===null)throw new L("CIUC00874");this._parent.removeChild(this)}}addChild(e,t,n){return t??(t=this._contentItems.length),this._contentItems.splice(t,0,e),e.setParent(this),this._isInitialised===!0&&e._isInitialised===!1&&e.init(),t}replaceChild(e,t,n=!1){const i=this._contentItems.indexOf(e),o=e._element.parentNode;if(i===-1)throw new S("CIRCI23232","Can't replace child. oldChild is not child of this");if(o===null)throw new L("CIRCP23232");if(o.replaceChild(t._element,e._element),n===!0&&(e._parent=null,e.destroy()),this._contentItems[i]=t,t.setParent(this),t.size=e.size,t.sizeUnit=e.sizeUnit,t.minSize=e.minSize,t.minSizeUnit=e.minSizeUnit,t._parent===null)throw new L("CIRCNC45699");t._parent._isInitialised===!0&&t._isInitialised===!1&&t.init(),this.updateSize(!1)}remove(){if(this._parent===null)throw new L("CIR11110");this._parent.removeChild(this)}popout(){const e=st(),t=this.layoutManager.createPopoutFromContentItem(this,void 0,e,void 0);return this.emitBaseBubblingEvent("stateChanged"),t}calculateConfigContent(){const e=this._contentItems,t=e.length,n=new Array(t);for(let i=0;i<t;i++){const o=e[i];n[i]=o.toConfig()}return n}highlightDropZone(e,t,n){const i=this.layoutManager.dropTargetIndicator;if(i===null)throw new L("ACIHDZ5593");i.highlightArea(n,1)}onDrop(e,t){this.addChild(e)}show(){this.layoutManager.beginSizeInvalidation();try{ie(this._element,!0);for(let e=0;e<this._contentItems.length;e++)this._contentItems[e].show()}finally{this.layoutManager.endSizeInvalidation()}}destroy(){for(let e=0;e<this._contentItems.length;e++)this._contentItems[e].destroy();this._contentItems=[],this.emitBaseBubblingEvent("beforeItemDestroyed"),this._element.remove(),this.emitBaseBubblingEvent("itemDestroyed")}getElementArea(e){e=e??this._element;const t=e.getBoundingClientRect(),n=t.top+document.body.scrollTop,i=t.left+document.body.scrollLeft,o=t.width,s=t.height;return{x1:i,y1:n,x2:i+o,y2:n+s,surface:o*s,contentItem:this}}init(){this._isInitialised=!0,this.emitBaseBubblingEvent("itemCreated"),this.emitUnknownBubblingEvent(this.type+"Created")}setParent(e){this._parent=e}addPopInParentId(e){this.popInParentIds.includes(e)||this.popInParentIds.push(e)}initContentItems(){for(let e=0;e<this._contentItems.length;e++)this._contentItems[e].init()}hide(){this.layoutManager.beginSizeInvalidation();try{ie(this._element,!1)}finally{this.layoutManager.endSizeInvalidation()}}updateContentItemsSize(e){for(let t=0;t<this._contentItems.length;t++)this._contentItems[t].updateSize(e)}createContentItems(e){const t=e.length,n=new Array(t);for(let i=0;i<e.length;i++)n[i]=this.layoutManager.createContentItem(e[i],this);return n}propagateEvent(e,t){if(t.length===1){const n=t[0];n instanceof z.BubblingEvent&&n.isPropagationStopped===!1&&this._isInitialised===!0&&(this.isGround===!1&&this._parent?this._parent.emitUnknown(e,n):this.scheduleEventPropagationToLayoutManager(e,n))}}tryBubbleEvent(e,t){if(t.length===1){const n=t[0];n instanceof z.BubblingEvent&&n.isPropagationStopped===!1&&this._isInitialised===!0&&(this.isGround===!1&&this._parent?this._parent.emitUnknown(e,n):this.scheduleEventPropagationToLayoutManager(e,n))}}scheduleEventPropagationToLayoutManager(e,t){this._throttledEvents.indexOf(e)===-1?this.layoutManager.emitUnknown(e,t):this._pendingEventPropagations[e]!==!0&&(this._pendingEventPropagations[e]=!0,globalThis.requestAnimationFrame(()=>this.propagateEventToLayoutManager(e,t)))}propagateEventToLayoutManager(e,t){this._pendingEventPropagations[e]=!1,this.layoutManager.emitUnknown(e,t)}}class le extends N{constructor(e,t,n){super(e,t,n,document.createElement("div")),this._parentItem=n,this._focused=!1,this.isComponent=!0,this._reorderEnabled=t.reorderEnabled,this.applyUpdatableConfig(t),this._initialWantMaximise=t.maximised;const i=document.createElement("div");i.classList.add("lm_content"),this.element.appendChild(i),this._container=new Lt(t,this,e,i,o=>this.handleUpdateItemConfigEvent(o),()=>this.show(),()=>this.hide(),o=>this.focus(o),o=>this.blur(o))}get componentName(){return this._container.componentType}get componentType(){return this._container.componentType}get reorderEnabled(){return this._reorderEnabled}get initialWantMaximise(){return this._initialWantMaximise}get component(){return this._container.component}get container(){return this._container}get parentItem(){return this._parentItem}get headerConfig(){return this._headerConfig}get title(){return this._title}get tab(){return this._tab}get focused(){return this._focused}destroy(){this._container.destroy(),super.destroy()}applyUpdatableConfig(e){this.setTitle(e.title),this._headerConfig=e.header}toConfig(){const e=this._container.stateRequestEvent,t=e===void 0?this._container.state:e();return{type:p.component,content:[],size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,maximised:!1,isClosable:this.isClosable,reorderEnabled:this._reorderEnabled,title:this._title,header:G.Header.createCopy(this._headerConfig),componentType:Q.copyComponentType(this.componentType),componentState:t}}close(){if(this.parent===null)throw new L("CIC68883");this.parent.removeChild(this,!1)}enterDragMode(e,t){W(this.element,e),O(this.element,t),this._container.enterDragMode(e,t)}exitDragMode(){this._container.exitDragMode()}enterStackMaximised(){this._container.enterStackMaximised()}exitStackMaximised(){this._container.exitStackMaximised()}drag(){this._container.drag()}updateSize(e){this.updateNodeSize(e)}init(){this.updateNodeSize(!1),super.init(),this._container.emit("open"),this.initContentItems()}setTitle(e){this._title=e,this.emit("titleChanged",e),this.emit("stateChanged")}setTab(e){this._tab=e,this.emit("tab",e),this._container.setTab(e)}hide(){super.hide(),this._container.setVisibility(!1)}show(){super.show(),this._container.setVisibility(!0)}focus(e=!1){this.parentItem.setActiveComponentItem(this,!0,e)}setFocused(e){this._focused=!0,this.tab.setFocused(),e||this.emitBaseBubblingEvent("focus")}blur(e=!1){this._focused&&this.layoutManager.setFocusedComponentItem(void 0,e)}setBlurred(e){this._focused=!1,this.tab.setBlurred(),e||this.emitBaseBubblingEvent("blur")}setParent(e){this._parentItem=e,super.setParent(e)}handleUpdateItemConfigEvent(e){this.applyUpdatableConfig(e)}updateNodeSize(e){if(this.element.style.display!=="none"){const{width:t,height:n}=ne(this.element);this._container.setSizeToNodeSize(t,n,e)}}}class rt extends N{constructor(){super(...arguments),this._focused=!1}get focused(){return this._focused}setFocusedValue(e){this._focused=e}}class et extends z{constructor(e,t){super(),this._eElement=e,this._pointerTracking=!1,this._pointerDownEventListener=n=>this.onPointerDown(n),this._pointerMoveEventListener=n=>this.onPointerMove(n),this._pointerUpEventListener=n=>this.onPointerUp(n),this._timeout=void 0,this._allowableTargets=[e,...t],this._oDocument=document,this._eBody=document.body,this._nDelay=1800,this._nDistance=10,this._nX=0,this._nY=0,this._nOriginalX=0,this._nOriginalY=0,this._dragging=!1,this._eElement.addEventListener("pointerdown",this._pointerDownEventListener,{passive:!0})}destroy(){this.checkRemovePointerTrackingEventListeners(),this._eElement.removeEventListener("pointerdown",this._pointerDownEventListener)}cancelDrag(){this.processDragStop(void 0)}onPointerDown(e){if(this._allowableTargets.includes(e.target)&&e.isPrimary){const t=this.getPointerCoordinates(e);this.processPointerDown(t)}}processPointerDown(e){this._nOriginalX=e.x,this._nOriginalY=e.y,this._oDocument.addEventListener("pointermove",this._pointerMoveEventListener),this._oDocument.addEventListener("pointerup",this._pointerUpEventListener,{passive:!0}),this._pointerTracking=!0,this._timeout=setTimeout(()=>{try{this.startDrag()}catch(t){throw console.error(t),t}},this._nDelay)}onPointerMove(e){this._pointerTracking&&(this.processDragMove(e),e.preventDefault())}processDragMove(e){this._nX=e.pageX-this._nOriginalX,this._nY=e.pageY-this._nOriginalY,this._dragging===!1&&(Math.abs(this._nX)>this._nDistance||Math.abs(this._nY)>this._nDistance)&&this.startDrag(),this._dragging&&this.emit("drag",this._nX,this._nY,e)}onPointerUp(e){this.processDragStop(e)}processDragStop(e){var t;this._timeout!==void 0&&(clearTimeout(this._timeout),this._timeout=void 0),this.checkRemovePointerTrackingEventListeners(),this._dragging===!0&&(this._eBody.classList.remove("lm_dragging"),this._eElement.classList.remove("lm_dragging"),(t=this._oDocument.querySelector("iframe"))===null||t===void 0||t.style.setProperty("pointer-events",""),this._dragging=!1,this.emit("dragStop",e))}checkRemovePointerTrackingEventListeners(){this._pointerTracking&&(this._oDocument.removeEventListener("pointermove",this._pointerMoveEventListener),this._oDocument.removeEventListener("pointerup",this._pointerUpEventListener),this._pointerTracking=!1)}startDrag(){var e;this._timeout!==void 0&&(clearTimeout(this._timeout),this._timeout=void 0),this._dragging=!0,this._eBody.classList.add("lm_dragging"),this._eElement.classList.add("lm_dragging"),(e=this._oDocument.querySelector("iframe"))===null||e===void 0||e.style.setProperty("pointer-events","none"),this.emit("dragStart",this._nOriginalX,this._nOriginalY)}getPointerCoordinates(e){return{x:e.pageX,y:e.pageY}}}class kt{constructor(e,t,n){this._isVertical=e,this._size=t,this._grabSize=n<this._size?this._size:n,this._element=document.createElement("div"),this._element.classList.add("lm_splitter");const i=document.createElement("div");i.classList.add("lm_drag_handle");const o=this._grabSize-this._size,s=o/2;this._isVertical?(i.style.top=I(-s),i.style.height=I(this._size+o),this._element.classList.add("lm_vertical"),this._element.style.height=I(this._size)):(i.style.left=I(-s),i.style.width=I(this._size+o),this._element.classList.add("lm_horizontal"),this._element.style.width=I(this._size)),this._element.appendChild(i),this._dragListener=new et(this._element,[i])}get element(){return this._element}destroy(){this._element.remove()}on(e,t){this._dragListener.on(e,t)}}class me extends N{constructor(e,t,n,i){switch(super(t,n,i,me.createElement(document,e)),this._rowOrColumnParent=i,this._splitter=[],this.isRow=!e,this.isColumn=e,this._childElementContainer=this.element,this._splitterSize=t.layoutConfig.dimensions.borderWidth,this._splitterGrabSize=t.layoutConfig.dimensions.borderGrabWidth,this._isColumn=e,this._dimension=e?"height":"width",this._splitterPosition=null,this._splitterMinPosition=null,this._splitterMaxPosition=null,n.type){case p.row:case p.column:this._configType=n.type;break;default:throw new S("ROCCCT00925")}}newComponent(e,t,n,i){const o={type:"component",componentType:e,componentState:t,title:n};return this.newItem(o,i)}addComponent(e,t,n,i){const o={type:"component",componentType:e,componentState:t,title:n};return this.addItem(o,i)}newItem(e,t){t=this.addItem(e,t);const n=this.contentItems[t];return N.isStack(n)&&R.isComponent(e)?n.contentItems[0]:n}addItem(e,t){this.layoutManager.checkMinimiseMaximisedStack();const n=R.resolve(e,!1),i=this.layoutManager.createAndInitContentItem(n,this);return this.addChild(i,t,!1)}addChild(e,t,n){if(t===void 0&&(t=this.contentItems.length),this.contentItems.length>0){const o=this.createSplitter(Math.max(0,t-1)).element;t>0?(this.contentItems[t-1].element.insertAdjacentElement("afterend",o),o.insertAdjacentElement("afterend",e.element)):(this.contentItems[0].element.insertAdjacentElement("beforebegin",o),o.insertAdjacentElement("beforebegin",e.element))}else this._childElementContainer.appendChild(e.element);super.addChild(e,t);const i=1/this.contentItems.length*100;if(n===!0)return this.emitBaseBubblingEvent("stateChanged"),t;for(let o=0;o<this.contentItems.length;o++){const s=this.contentItems[o];if(s===e)e.size=i;else{const a=s.size*=(100-i)/100;s.size=a}}return this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged"),t}removeChild(e,t){const n=this.contentItems.indexOf(e),i=Math.max(n-1,0);if(n===-1)throw new Error("Can't remove child. ContentItem is not child of this Row or Column");if(this._splitter[i]&&(this._splitter[i].destroy(),this._splitter.splice(i,1)),super.removeChild(e,t),this.contentItems.length===1&&this.isClosable===!0){const o=this.contentItems[0];this.contentItems.length=0,this._rowOrColumnParent.replaceChild(this,o,!0)}else this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged")}replaceChild(e,t){const n=e.size;super.replaceChild(e,t),t.size=n,this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged")}updateSize(e){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(e)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}init(){if(this.isInitialised!==!0){this.updateNodeSize();for(let e=0;e<this.contentItems.length;e++)this._childElementContainer.appendChild(this.contentItems[e].element);super.init();for(let e=0;e<this.contentItems.length-1;e++)this.contentItems[e].element.insertAdjacentElement("afterend",this.createSplitter(e).element);this.initContentItems()}}toConfig(){return{type:this.type,content:this.calculateConfigContent(),size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,isClosable:this.isClosable}}setParent(e){this._rowOrColumnParent=e,super.setParent(e)}updateNodeSize(){this.contentItems.length>0&&(this.calculateRelativeSizes(),this.setAbsoluteSizes()),this.emitBaseBubblingEvent("stateChanged"),this.emit("resize")}setAbsoluteSizes(){const e=this.calculateAbsoluteSizes();for(let t=0;t<this.contentItems.length;t++)e.additionalPixel-t>0&&e.itemSizes[t]++,this._isColumn?(W(this.contentItems[t].element,e.crossAxisSize),O(this.contentItems[t].element,e.itemSizes[t])):(W(this.contentItems[t].element,e.itemSizes[t]),O(this.contentItems[t].element,e.crossAxisSize))}calculateAbsoluteSizes(){const e=(this.contentItems.length-1)*this._splitterSize,{width:t,height:n}=ne(this.element);let i,o;this._isColumn?(i=n-e,o=t):(i=t-e,o=n);let s=0;const a=[];for(let d=0;d<this.contentItems.length;d++){const c=this.contentItems[d];let u;if(c.sizeUnit===E.Percent)u=Math.floor(i*(c.size/100));else throw new S("ROCCAS6692");s+=u,a.push(u)}const l=Math.floor(i-s);return{itemSizes:a,additionalPixel:l,totalSize:i,crossAxisSize:o}}calculateRelativeSizes(){let e=0;const t=[];let n=0;for(let i=0;i<this.contentItems.length;i++){const o=this.contentItems[i];switch(o.sizeUnit){case E.Percent:{e+=o.size;break}case E.Fractional:{t.push(o),n+=o.size;break}default:throw new S("ROCCRS49110",JSON.stringify(o))}}if(Math.round(e)===100){this.respectMinItemSize();return}else if(Math.round(e)<100&&t.length>0){const i=100-e;for(let o=0;o<t.length;o++){const s=t[o];s.size=i*(s.size/n),s.sizeUnit=E.Percent}this.respectMinItemSize();return}else{if(Math.round(e)>100&&t.length>0){for(let i=0;i<t.length;i++){const o=t[i];o.size=50*(o.size/n),o.sizeUnit=E.Percent}e+=50}for(let i=0;i<this.contentItems.length;i++){const o=this.contentItems[i];o.size=o.size/e*100}this.respectMinItemSize()}}respectMinItemSize(){const e=this.calculateContentItemMinSize(this);if(!(e<=0||this.contentItems.length<=1)){let t=0,n=0;const i=[],o=[],s=this.calculateAbsoluteSizes();for(let a=0;a<s.itemSizes.length;a++){const l=s.itemSizes[a];let d;l<e?(n+=e-l,d={size:e}):(t+=l-e,d={size:l},i.push(d)),o.push(d)}if(n===0||n>t)return;{const a=n/t;let l=n;for(let d=0;d<i.length;d++){const c=i[d],u=Math.round((c.size-e)*a);l-=u,c.size-=u}l!==0&&(o[o.length-1].size-=l);for(let d=0;d<this.contentItems.length;d++){const c=this.contentItems[d];c.size=o[d].size/s.totalSize*100}}}}createSplitter(e){const t=new kt(this._isColumn,this._splitterSize,this._splitterGrabSize);return t.on("drag",(n,i)=>this.onSplitterDrag(t,n,i)),t.on("dragStop",()=>this.onSplitterDragStop(t)),t.on("dragStart",()=>this.onSplitterDragStart(t)),this._splitter.splice(e,0,t),t}getSplitItems(e){const t=this._splitter.indexOf(e);return{before:this.contentItems[t],after:this.contentItems[t+1]}}calculateContentItemMinSize(e){const t=e.minSize;if(t!==void 0){if(e.minSizeUnit===E.Pixel)return t;throw new S("ROCGMD98831",JSON.stringify(e))}else{const n=this.layoutManager.layoutConfig.dimensions;return this._isColumn?n.defaultMinItemHeight:n.defaultMinItemWidth}}calculateContentItemsTotalMinSize(e){let t=0;for(const n of e)t+=this.calculateContentItemMinSize(n);return t}onSplitterDragStart(e){const t=this.getSplitItems(e),n=ye(t.before.element.style[this._dimension]),i=ye(t.after.element.style[this._dimension]),o=this.calculateContentItemsTotalMinSize(t.before.contentItems),s=this.calculateContentItemsTotalMinSize(t.after.contentItems);this._splitterPosition=0,this._splitterMinPosition=-1*(n-o),this._splitterMaxPosition=i-s}onSplitterDrag(e,t,n){let i=this._isColumn?n:t;if(this._splitterMinPosition===null||this._splitterMaxPosition===null)throw new L("ROCOSD59226");i=Math.max(i,this._splitterMinPosition),i=Math.min(i,this._splitterMaxPosition),this._splitterPosition=i;const o=I(i);this._isColumn?e.element.style.top=o:e.element.style.left=o}onSplitterDragStop(e){if(this._splitterPosition===null)throw new L("ROCOSDS66932");{const t=this.getSplitItems(e),n=ye(t.before.element.style[this._dimension]),i=ye(t.after.element.style[this._dimension]),o=(this._splitterPosition+n)/(n+i),s=t.before.size+t.after.size;t.before.size=o*s,t.after.size=(1-o)*s,e.element.style.top=I(0),e.element.style.left=I(0),globalThis.requestAnimationFrame(()=>this.updateSize(!1))}}}(function(r){function e(i,o){return o==="width"?wt(i):St(i)}r.getElementDimensionSize=e;function t(i,o,s){return o==="width"?W(i,s):O(i,s)}r.setElementDimensionSize=t;function n(i,o){const s=i.createElement("div");return s.classList.add("lm_item"),o?s.classList.add("lm_column"):s.classList.add("lm_row"),s}r.createElement=n})(me||(me={}));class re extends rt{constructor(e,t,n){super(e,Xe.create(t),null,re.createElement(document)),this.isGround=!0,this._childElementContainer=this.element,this._containerElement=n;let i=null;for(;;){const o=i?i.previousSibling:this._containerElement.lastChild;if(o instanceof Element&&o.classList.contains("lm_content"))i=o;else break}this._containerElement.insertBefore(this.element,i)}init(){if(this.isInitialised!==!0){this.updateNodeSize();for(let e=0;e<this.contentItems.length;e++)this._childElementContainer.appendChild(this.contentItems[e].element);super.init(),this.initContentItems()}}loadRoot(e){if(this.clearRoot(),e!==void 0){const t=this.layoutManager.createAndInitContentItem(e,this);this.addChild(t,0)}}clearRoot(){const e=this.contentItems;switch(e.length){case 0:return;case 1:{e[0].remove();return}default:throw new S("GILR07721")}}addItem(e,t){this.layoutManager.checkMinimiseMaximisedStack();const n=R.resolve(e,!1);let i;if(this.contentItems.length>0?i=this.contentItems[0]:i=this,i.isComponent)throw new Error("Cannot add item as child to ComponentItem");{const o=this.layoutManager.createAndInitContentItem(n,i);return t=i.addChild(o,t),i===this?-1:t}}loadComponentAsRoot(e){this.clearRoot();const t=R.resolve(e,!1);if(t.maximised)throw new Error("Root Component cannot be maximised");{const n=new le(this.layoutManager,t,this);n.init(),this.addChild(n,0)}}addChild(e,t){if(this.contentItems.length>0)throw new Error("Ground node can only have a single child");return this._childElementContainer.appendChild(e.element),t=super.addChild(e,t),this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged"),t}calculateConfigContent(){const e=this.contentItems,t=e.length,n=new Array(t);for(let i=0;i<t;i++){const s=e[i].toConfig();if(ue.isRootItemConfig(s))n[i]=s;else throw new S("RCCC66832")}return n}setSize(e,t){e===void 0||t===void 0?this.updateSize(!1):(W(this.element,e),O(this.element,t),this.contentItems.length>0&&(W(this.contentItems[0].element,e),O(this.contentItems[0].element,t)),this.updateContentItemsSize(!1))}updateSize(e){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(e)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}createSideAreas(){const t=re.Area.oppositeSides,n=new Array(Object.keys(t).length);let i=0;for(const o in t){const s=o,a=this.getElementArea();if(a===null)throw new L("RCSA77553");a.side=s,t[s][1]==="2"?a[s]=a[t[s]]-50:a[s]=a[t[s]]+50,a.surface=(a.x2-a.x1)*(a.y2-a.y1),n[i++]=a}return n}highlightDropZone(e,t,n){this.layoutManager.tabDropPlaceholder.remove(),super.highlightDropZone(e,t,n)}onDrop(e,t){if(e.isComponent){const n=K.createDefault(),i=e;n.header=G.Header.createCopy(i.headerConfig);const o=this.layoutManager.createAndInitContentItem(n,this);o.addChild(e),e=o}if(this.contentItems.length===0)this.addChild(e);else{if(e.type===p.row||e.type===p.column){const s=K.createDefault(),a=this.layoutManager.createContentItem(s,this);a.addChild(e),e=a}const n=t.side[0]=="x"?p.row:p.column,i=t.side[1]=="2",o=this.contentItems[0];if(!(o instanceof me)||o.type!==n){const s=w.createDefault(n),a=this.layoutManager.createContentItem(s,this);this.replaceChild(o,a),a.addChild(e,i?0:void 0,!0),a.addChild(o,i?void 0:0,!0),o.size=50,e.size=50,e.sizeUnit=E.Percent,a.updateSize(!1)}else{const s=o.contentItems[i?0:o.contentItems.length-1];o.addChild(e,i?0:void 0,!0),s.size*=.5,e.size=s.size,e.sizeUnit=E.Percent,o.updateSize(!1)}}}dock(){throw new S("GID87731")}validateDocking(){throw new S("GIVD87732")}getAllContentItems(){const e=[this];return this.deepGetAllContentItems(this.contentItems,e),e}getConfigMaximisedItems(){const e=[];return this.deepFilterContentItems(this.contentItems,e,t=>N.isStack(t)&&t.initialWantMaximise?!0:!!(N.isComponentItem(t)&&t.initialWantMaximise)),e}getItemsByPopInParentId(e){const t=[];return this.deepFilterContentItems(this.contentItems,t,n=>n.popInParentIds.includes(e)),t}toConfig(){throw new Error("Cannot generate GroundItem config")}setActiveComponentItem(e,t,n){}updateNodeSize(){const{width:e,height:t}=ne(this._containerElement);W(this.element,e),O(this.element,t),this.contentItems.length>0&&(W(this.contentItems[0].element,e),O(this.contentItems[0].element,t))}deepGetAllContentItems(e,t){for(let n=0;n<e.length;n++){const i=e[n];t.push(i),this.deepGetAllContentItems(i.contentItems,t)}}deepFilterContentItems(e,t,n){for(let i=0;i<e.length;i++){const o=e[i];n(o)&&t.push(o),this.deepFilterContentItems(o.contentItems,t,n)}}}(function(r){(function(t){t.oppositeSides={y2:"y1",x2:"x1",y1:"y2",x1:"x2"}})(r.Area||(r.Area={}));function e(t){const n=t.createElement("div");return n.classList.add("lm_goldenlayout"),n.classList.add("lm_item"),n.classList.add("lm_root"),n}r.createElement=e})(re||(re={}));class He{constructor(e,t,n,i){this._header=e,this._pushEvent=i,this._clickEventListener=o=>this.onClick(o),this._touchStartEventListener=o=>this.onTouchStart(o),this._element=document.createElement("div"),this._element.classList.add(n),this._element.title=t,this._header.on("destroy",()=>this.destroy()),this._element.addEventListener("click",this._clickEventListener,{passive:!0}),this._element.addEventListener("touchstart",this._touchStartEventListener,{passive:!0}),this._header.controlsContainerElement.appendChild(this._element)}get element(){return this._element}destroy(){var e;this._element.removeEventListener("click",this._clickEventListener),this._element.removeEventListener("touchstart",this._touchStartEventListener),(e=this._element.parentNode)===null||e===void 0||e.removeChild(this._element)}onClick(e){this._pushEvent(e)}onTouchStart(e){this._pushEvent(e)}}class Rt{constructor(e,t,n,i,o){var s;this._layoutManager=e,this._componentItem=t,this._closeEvent=n,this._focusEvent=i,this._dragStartEvent=o,this._isActive=!1,this._tabClickListener=l=>this.onTabClickDown(l),this._tabTouchStartListener=l=>this.onTabTouchStart(l),this._closeClickListener=()=>this.onCloseClick(),this._closeTouchStartListener=()=>this.onCloseTouchStart(),this._dragStartListener=(l,d)=>this.onDragStart(l,d),this._contentItemDestroyListener=()=>this.onContentItemDestroy(),this._tabTitleChangedListener=l=>this.setTitle(l),this._element=document.createElement("div"),this._element.classList.add("lm_tab"),this._titleElement=document.createElement("span"),this._titleElement.classList.add("lm_title"),this._closeElement=document.createElement("div"),this._closeElement.classList.add("lm_close_tab"),this._element.appendChild(this._titleElement),this._element.appendChild(this._closeElement),t.isClosable?this._closeElement.style.display="":this._closeElement.style.display="none",this.setTitle(t.title),this._componentItem.on("titleChanged",this._tabTitleChangedListener),((s=t.reorderEnabled)!==null&&s!==void 0?s:this._layoutManager.layoutConfig.settings.reorderEnabled)&&this.enableReorder(),this._element.addEventListener("click",this._tabClickListener,{passive:!0}),this._element.addEventListener("touchstart",this._tabTouchStartListener,{passive:!0}),this._componentItem.isClosable?(this._closeElement.addEventListener("click",this._closeClickListener,{passive:!0}),this._closeElement.addEventListener("touchstart",this._closeTouchStartListener,{passive:!0})):(this._closeElement.remove(),this._closeElement=void 0),this._componentItem.setTab(this),this._layoutManager.emit("tabCreated",this)}get isActive(){return this._isActive}get componentItem(){return this._componentItem}get contentItem(){return this._componentItem}get element(){return this._element}get titleElement(){return this._titleElement}get closeElement(){return this._closeElement}get reorderEnabled(){return this._dragListener!==void 0}set reorderEnabled(e){e!==this.reorderEnabled&&(e?this.enableReorder():this.disableReorder())}setTitle(e){this._titleElement.innerText=e,this._element.title=e}setActive(e){e!==this._isActive&&(this._isActive=e,e?this._element.classList.add("lm_active"):this._element.classList.remove("lm_active"))}destroy(){var e,t;this._closeEvent=void 0,this._focusEvent=void 0,this._dragStartEvent=void 0,this._element.removeEventListener("click",this._tabClickListener),this._element.removeEventListener("touchstart",this._tabTouchStartListener),(e=this._closeElement)===null||e===void 0||e.removeEventListener("click",this._closeClickListener),(t=this._closeElement)===null||t===void 0||t.removeEventListener("touchstart",this._closeTouchStartListener),this._componentItem.off("titleChanged",this._tabTitleChangedListener),this.reorderEnabled&&this.disableReorder(),this._element.remove()}setBlurred(){this._element.classList.remove("lm_focused"),this._titleElement.classList.remove("lm_focused")}setFocused(){this._element.classList.add("lm_focused"),this._titleElement.classList.add("lm_focused")}onDragStart(e,t){if(this._dragListener===void 0)throw new v("TODSDLU10093");if(this._dragStartEvent===void 0)throw new v("TODS23309");this._dragStartEvent(e,t,this._dragListener,this.componentItem)}onContentItemDestroy(){this._dragListener!==void 0&&(this._dragListener.destroy(),this._dragListener=void 0)}onTabClickDown(e){const t=e.target;(t===this._element||t===this._titleElement)&&(e.button===0?this.notifyFocus():e.button===1&&this._componentItem.isClosable&&this.notifyClose())}onTabTouchStart(e){e.target===this._element&&this.notifyFocus()}onCloseClick(){this.notifyClose()}onCloseTouchStart(){this.notifyClose()}notifyClose(){if(this._closeEvent===void 0)throw new v("TNC15007");this._closeEvent(this._componentItem)}notifyFocus(){if(this._focusEvent===void 0)throw new v("TNA15007");this._focusEvent(this._componentItem)}enableReorder(){this._dragListener=new et(this._element,[this._titleElement]),this._dragListener.on("dragStart",this._dragStartListener),this._componentItem.on("destroy",this._contentItemDestroyListener)}disableReorder(){if(this._dragListener===void 0)throw new v("TDR87745");this._componentItem.off("destroy",this._contentItemDestroyListener),this._dragListener.off("dragStart",this._dragStartListener),this._dragListener=void 0}}class zt{constructor(e,t,n,i,o){this._layoutManager=e,this._componentRemoveEvent=t,this._componentFocusEvent=n,this._componentDragStartEvent=i,this._dropdownActiveChangedEvent=o,this._tabs=[],this._lastVisibleTabIndex=-1,this._dropdownActive=!1,this._element=document.createElement("section"),this._element.classList.add("lm_tabs"),this._dropdownElement=document.createElement("section"),this._dropdownElement.classList.add("lm_tabdropdown_list"),this._dropdownElement.style.display="none"}get tabs(){return this._tabs}get tabCount(){return this._tabs.length}get lastVisibleTabIndex(){return this._lastVisibleTabIndex}get element(){return this._element}get dropdownElement(){return this._dropdownElement}get dropdownActive(){return this._dropdownActive}destroy(){for(let e=0;e<this._tabs.length;e++)this._tabs[e].destroy()}createTab(e,t){for(let i=0;i<this._tabs.length;i++)if(this._tabs[i].componentItem===e)return;const n=new Rt(this._layoutManager,e,i=>this.handleTabCloseEvent(i),i=>this.handleTabFocusEvent(i),(i,o,s,a)=>this.handleTabDragStartEvent(i,o,s,a));t===void 0&&(t=this._tabs.length),this._tabs.splice(t,0,n),t<this._element.childNodes.length?this._element.insertBefore(n.element,this._element.childNodes[t]):this._element.appendChild(n.element)}removeTab(e){for(let t=0;t<this._tabs.length;t++)if(this._tabs[t].componentItem===e){this._tabs[t].destroy(),this._tabs.splice(t,1);return}throw new Error("contentItem is not controlled by this header")}processActiveComponentChanged(e){let t=-1;for(let n=0;n<this._tabs.length;n++){const i=this._tabs[n].componentItem===e;this._tabs[n].setActive(i),i&&(t=n)}if(t<0)throw new S("HSACI56632");if(this._layoutManager.layoutConfig.settings.reorderOnTabMenuClick&&this._lastVisibleTabIndex!==-1&&t>this._lastVisibleTabIndex){const n=this._tabs[t];for(let i=t;i>0;i--)this._tabs[i]=this._tabs[i-1];this._tabs[0]=n}}updateTabSizes(e,t){let n=!1;this.tryUpdateTabSizes(n,e,t)||(n=!0,this.tryUpdateTabSizes(n,e,t)),n!==this._dropdownActive&&(this._dropdownActive=n,this._dropdownActiveChangedEvent())}tryUpdateTabSizes(e,t,n){if(this._tabs.length>0){if(n===void 0)throw new Error("non-empty tabs must have active component item");let i=0,o=!1;const s=this._layoutManager.layoutConfig.settings.tabOverlapAllowance,a=this._tabs.indexOf(n.tab),l=this._tabs[a];this._lastVisibleTabIndex=-1;for(let d=0;d<this._tabs.length;d++){const c=this._tabs[d].element;c.parentElement!==this._element&&this._element.appendChild(c);const u=getComputedStyle(l.element).marginRight,m=ye(u),h=c.offsetWidth+m;i+=h;let f=0;if(a<=d)f=i;else{const g=getComputedStyle(l.element).marginRight,y=ye(g);f=i+l.element.offsetWidth+y}if(f>t){if(o)d===a&&(c.style.zIndex="auto",c.style.marginLeft="",c.parentElement!==this._element&&this._element.appendChild(c));else{let g;if(a>0&&a<=d?g=(f-t)/(d-1):g=(f-t)/d,g<s){for(let y=0;y<=d;y++){const b=y!==a&&y!==0?"-"+I(g):"";this._tabs[y].element.style.zIndex=I(d-y),this._tabs[y].element.style.marginLeft=b}this._lastVisibleTabIndex=d,c.parentElement!==this._element&&this._element.appendChild(c)}else o=!0}if(o&&d!==a)if(e)c.style.zIndex="auto",c.style.marginLeft="",c.parentElement!==this._dropdownElement&&this._dropdownElement.appendChild(c);else return!1}else this._lastVisibleTabIndex=d,c.style.zIndex="auto",c.style.marginLeft="",c.parentElement!==this._element&&this._element.appendChild(c)}}return!0}showAdditionalTabsDropdown(){this._dropdownElement.style.display=""}hideAdditionalTabsDropdown(){this._dropdownElement.style.display="none"}handleTabCloseEvent(e){this._componentRemoveEvent(e)}handleTabFocusEvent(e){this._componentFocusEvent(e)}handleTabDragStartEvent(e,t,n,i){this._componentDragStartEvent(e,t,n,i)}}class Mt extends z{constructor(e,t,n,i,o,s,a,l,d,c,u,m,h){super(),this._layoutManager=e,this._parent=t,this._configClosable=i,this._getActiveComponentItemEvent=o,this._popoutEvent=a,this._maximiseToggleEvent=l,this._clickEvent=d,this._touchStartEvent=c,this._componentRemoveEvent=u,this._componentFocusEvent=m,this._componentDragStartEvent=h,this._clickListener=f=>this.onClick(f),this._touchStartListener=f=>this.onTouchStart(f),this._rowColumnClosable=!0,this._closeButton=null,this._popoutButton=null,this._tabsContainer=new zt(this._layoutManager,f=>this.handleTabInitiatedComponentRemoveEvent(f),f=>this.handleTabInitiatedComponentFocusEvent(f),(f,g,y,b)=>this.handleTabInitiatedDragStartEvent(f,g,y,b),()=>this.processTabDropdownActiveChanged()),this._show=n.show,this._popoutEnabled=n.popoutEnabled,this._popoutLabel=n.popoutLabel,this._maximiseEnabled=n.maximiseEnabled,this._maximiseLabel=n.maximiseLabel,this._minimiseEnabled=n.minimiseEnabled,this._minimiseLabel=n.minimiseLabel,this._closeEnabled=n.closeEnabled,this._closeLabel=n.closeLabel,this._tabDropdownEnabled=n.tabDropdownEnabled,this._tabDropdownLabel=n.tabDropdownLabel,this.setSide(n.side),this._canRemoveComponent=this._configClosable,this._element=document.createElement("section"),this._element.classList.add("lm_header"),this._controlsContainerElement=document.createElement("section"),this._controlsContainerElement.classList.add("lm_controls"),this._element.appendChild(this._tabsContainer.element),this._element.appendChild(this._controlsContainerElement),this._element.appendChild(this._tabsContainer.dropdownElement),this._element.addEventListener("click",this._clickListener,{passive:!0}),this._element.addEventListener("touchstart",this._touchStartListener,{passive:!0}),this._documentMouseUpListener=()=>this._tabsContainer.hideAdditionalTabsDropdown(),globalThis.document.addEventListener("mouseup",this._documentMouseUpListener,{passive:!0}),this._tabControlOffset=this._layoutManager.layoutConfig.settings.tabControlOffset,this._tabDropdownEnabled&&(this._tabDropdownButton=new He(this,this._tabDropdownLabel,"lm_tabdropdown",()=>this._tabsContainer.showAdditionalTabsDropdown())),this._popoutEnabled&&(this._popoutButton=new He(this,this._popoutLabel,"lm_popout",()=>this.handleButtonPopoutEvent())),this._maximiseEnabled&&(this._maximiseButton=new He(this,this._maximiseLabel,"lm_maximise",f=>this.handleButtonMaximiseToggleEvent(f))),this._configClosable&&(this._closeButton=new He(this,this._closeLabel,"lm_close",()=>s())),this.processTabDropdownActiveChanged()}get show(){return this._show}get side(){return this._side}get leftRightSided(){return this._leftRightSided}get layoutManager(){return this._layoutManager}get parent(){return this._parent}get tabs(){return this._tabsContainer.tabs}get lastVisibleTabIndex(){return this._tabsContainer.lastVisibleTabIndex}get element(){return this._element}get tabsContainerElement(){return this._tabsContainer.element}get controlsContainerElement(){return this._controlsContainerElement}destroy(){this.emit("destroy"),this._popoutEvent=void 0,this._maximiseToggleEvent=void 0,this._clickEvent=void 0,this._touchStartEvent=void 0,this._componentRemoveEvent=void 0,this._componentFocusEvent=void 0,this._componentDragStartEvent=void 0,this._tabsContainer.destroy(),globalThis.document.removeEventListener("mouseup",this._documentMouseUpListener),this._element.remove()}createTab(e,t){this._tabsContainer.createTab(e,t)}removeTab(e){this._tabsContainer.removeTab(e)}processActiveComponentChanged(e){this._tabsContainer.processActiveComponentChanged(e),this.updateTabSizes()}setSide(e){this._side=e,this._leftRightSided=[oe.right,oe.left].includes(this._side)}setRowColumnClosable(e){this._rowColumnClosable=e,this.updateClosability()}updateClosability(){let e;if(!this._configClosable)e=!1;else if(!this._rowColumnClosable)e=!1;else{e=!0;const t=this.tabs.length;for(let n=0;n<t;n++)if(!this._tabsContainer.tabs[n].componentItem.isClosable){e=!1;break}}this._closeButton!==null&&ie(this._closeButton.element,e),this._popoutButton!==null&&ie(this._popoutButton.element,e),this._canRemoveComponent=e||this._tabsContainer.tabCount>1}applyFocusedValue(e){e?this._element.classList.add("lm_focused"):this._element.classList.remove("lm_focused")}processMaximised(){if(this._maximiseButton===void 0)throw new v("HPMAX16997");this._maximiseButton.element.setAttribute("title",this._minimiseLabel)}processMinimised(){if(this._maximiseButton===void 0)throw new v("HPMIN16997");this._maximiseButton.element.setAttribute("title",this._maximiseLabel)}updateTabSizes(){if(this._tabsContainer.tabCount>0){const e=this._show?this._layoutManager.layoutConfig.dimensions.headerHeight:0;this._leftRightSided?(this._element.style.height="",this._element.style.width=I(e)):(this._element.style.width="",this._element.style.height=I(e));let t;this._leftRightSided?t=this._element.offsetHeight-this._controlsContainerElement.offsetHeight-this._tabControlOffset:t=this._element.offsetWidth-this._controlsContainerElement.offsetWidth-this._tabControlOffset,this._tabsContainer.updateTabSizes(t,this._getActiveComponentItemEvent())}}handleTabInitiatedComponentRemoveEvent(e){if(this._canRemoveComponent){if(this._componentRemoveEvent===void 0)throw new v("HHTCE22294");this._componentRemoveEvent(e)}}handleTabInitiatedComponentFocusEvent(e){if(this._componentFocusEvent===void 0)throw new v("HHTAE22294");this._componentFocusEvent(e)}handleTabInitiatedDragStartEvent(e,t,n,i){if(!this._canRemoveComponent)n.cancelDrag();else{if(this._componentDragStartEvent===void 0)throw new v("HHTDSE22294");this._componentDragStartEvent(e,t,n,i)}}processTabDropdownActiveChanged(){this._tabDropdownButton!==void 0&&ie(this._tabDropdownButton.element,this._tabsContainer.dropdownActive)}handleButtonPopoutEvent(){if(this._layoutManager.layoutConfig.settings.popoutWholeStack){if(this._popoutEvent===void 0)throw new v("HHBPOE17834");this._popoutEvent()}else{const e=this._getActiveComponentItemEvent();e&&e.popout()}}handleButtonMaximiseToggleEvent(e){if(this._maximiseToggleEvent===void 0)throw new v("HHBMTE16834");this._maximiseToggleEvent()}onClick(e){e.target===this._element&&this.notifyClick(e)}onTouchStart(e){e.target===this._element&&this.notifyTouchStart(e)}notifyClick(e){if(this._clickEvent===void 0)throw new v("HNHC46834");this._clickEvent(e)}notifyTouchStart(e){if(this._touchStartEvent===void 0)throw new v("HNHTS46834");this._touchStartEvent(e)}}class J extends rt{constructor(e,t,n){var i,o,s,a,l,d,c,u,m,h,f,g,y,b,x,A,P,k,F;super(e,t,n,J.createElement(document)),this._headerSideChanged=!1,this._resizeListener=()=>this.handleResize(),this._maximisedListener=()=>this.handleMaximised(),this._minimisedListener=()=>this.handleMinimised(),this._headerConfig=t.header;const M=e.layoutConfig.header,pe=t.content;let T;pe.length!==1?T=void 0:T=pe[0].header,this._initialWantMaximise=t.maximised,this._initialActiveItemIndex=(i=t.activeItemIndex)!==null&&i!==void 0?i:0;const fe=(a=(s=(o=this._headerConfig)===null||o===void 0?void 0:o.show)!==null&&s!==void 0?s:T?.show)!==null&&a!==void 0?a:M.show,_e=(c=(d=(l=this._headerConfig)===null||l===void 0?void 0:l.popout)!==null&&d!==void 0?d:T?.popout)!==null&&c!==void 0?c:M.popout,ge=(h=(m=(u=this._headerConfig)===null||u===void 0?void 0:u.maximise)!==null&&m!==void 0?m:T?.maximise)!==null&&h!==void 0?h:M.maximise,ee=(y=(g=(f=this._headerConfig)===null||f===void 0?void 0:f.close)!==null&&g!==void 0?g:T?.close)!==null&&y!==void 0?y:M.close,lt=(A=(x=(b=this._headerConfig)===null||b===void 0?void 0:b.minimise)!==null&&x!==void 0?x:T?.minimise)!==null&&A!==void 0?A:M.minimise,Ge=(F=(k=(P=this._headerConfig)===null||P===void 0?void 0:P.tabDropdown)!==null&&k!==void 0?k:T?.tabDropdown)!==null&&F!==void 0?F:M.tabDropdown;this._maximisedEnabled=ge!==!1;const dt={show:fe!==!1,side:fe===!1?oe.top:fe,popoutEnabled:_e!==!1,popoutLabel:_e===!1?"":_e,maximiseEnabled:this._maximisedEnabled,maximiseLabel:ge===!1?"":ge,closeEnabled:ee!==!1,closeLabel:ee===!1?"":ee,minimiseEnabled:!0,minimiseLabel:lt,tabDropdownEnabled:Ge!==!1,tabDropdownLabel:Ge===!1?"":Ge};this._header=new Mt(e,this,dt,t.isClosable&&ee!==!1,()=>this.getActiveComponentItem(),()=>this.remove(),()=>this.handlePopoutEvent(),()=>this.toggleMaximise(),q=>this.handleHeaderClickEvent(q),q=>this.handleHeaderTouchStartEvent(q),q=>this.handleHeaderComponentRemoveEvent(q),q=>this.handleHeaderComponentFocusEvent(q),(q,ct,ht,ut)=>this.handleHeaderComponentStartDragEvent(q,ct,ht,ut)),this.isStack=!0,this._childElementContainer=document.createElement("section"),this._childElementContainer.classList.add("lm_items"),this.on("resize",this._resizeListener),this._maximisedEnabled&&(this.on("maximised",this._maximisedListener),this.on("minimised",this._minimisedListener)),this.element.appendChild(this._header.element),this.element.appendChild(this._childElementContainer),this.setupHeaderPosition(),this._header.updateClosability()}get childElementContainer(){return this._childElementContainer}get header(){return this._header}get headerShow(){return this._header.show}get headerSide(){return this._header.side}get headerLeftRightSided(){return this._header.leftRightSided}get contentAreaDimensions(){return this._contentAreaDimensions}get initialWantMaximise(){return this._initialWantMaximise}get isMaximised(){return this===this.layoutManager.maximisedStack}get stackParent(){if(!this.parent)throw new Error("Stack should always have a parent");return this.parent}updateSize(e){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(e)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}init(){if(this.isInitialised===!0)return;this.updateNodeSize();for(let n=0;n<this.contentItems.length;n++)this._childElementContainer.appendChild(this.contentItems[n].element);super.init();const e=this.contentItems,t=e.length;if(t>0){if(this._initialActiveItemIndex<0||this._initialActiveItemIndex>=t)throw new Error(`ActiveItemIndex out of range: ${this._initialActiveItemIndex} id: ${this.id}`);for(let n=0;n<t;n++){const i=e[n];if(i instanceof le)this._header.createTab(i,n),i.hide(),i.container.setBaseLogicalZIndex();else throw new Error(`Stack Content Item is not of type ComponentItem: ${n} id: ${this.id}`)}this.setActiveComponentItem(e[this._initialActiveItemIndex],!1),this._header.updateTabSizes()}this._header.updateClosability(),this.initContentItems()}setActiveContentItem(e){if(N.isComponentItem(e))this.setActiveComponentItem(e,!1);else throw new Error("Stack.setActiveContentItem: item is not a ComponentItem")}setActiveComponentItem(e,t,n=!1){if(this._activeComponentItem!==e){if(this.contentItems.indexOf(e)===-1)throw new Error("componentItem is not a child of this stack");this.layoutManager.beginSizeInvalidation();try{this._activeComponentItem!==void 0&&this._activeComponentItem.hide(),this._activeComponentItem=e,this._header.processActiveComponentChanged(e),e.show()}finally{this.layoutManager.endSizeInvalidation()}this.emit("activeContentItemChanged",e),this.layoutManager.emit("activeContentItemChanged",e),this.emitStateChangedEvent()}(this.focused||t)&&this.layoutManager.setFocusedComponentItem(e,n)}getActiveContentItem(){var e;return(e=this.getActiveComponentItem())!==null&&e!==void 0?e:null}getActiveComponentItem(){return this._activeComponentItem}focusActiveContentItem(){var e;(e=this._activeComponentItem)===null||e===void 0||e.focus()}setFocusedValue(e){this._header.applyFocusedValue(e),super.setFocusedValue(e)}setRowColumnClosable(e){this._header.setRowColumnClosable(e)}newComponent(e,t,n,i){const o={type:"component",componentType:e,componentState:t,title:n};return this.newItem(o,i)}addComponent(e,t,n,i){const o={type:"component",componentType:e,componentState:t,title:n};return this.addItem(o,i)}newItem(e,t){return t=this.addItem(e,t),this.contentItems[t]}addItem(e,t){this.layoutManager.checkMinimiseMaximisedStack();const n=R.resolve(e,!1),i=this.layoutManager.createAndInitContentItem(n,this);return this.addChild(i,t)}addChild(e,t,n=!1){if(t!==void 0&&t>this.contentItems.length)throw t-=1,new S("SAC99728");if(e instanceof le)return t=super.addChild(e,t),this._childElementContainer.appendChild(e.element),this._header.createTab(e,t),this.setActiveComponentItem(e,n),this._header.updateTabSizes(),this.updateSize(!1),e.container.setBaseLogicalZIndex(),this._header.updateClosability(),this.emitStateChangedEvent(),t;throw new S("SACC88532")}removeChild(e,t){const n=e,i=this.contentItems.indexOf(n),o=this.contentItems.length===1;if(this._activeComponentItem===n&&(n.focused&&n.blur(),!o)){const s=i===0?1:i-1;this.setActiveComponentItem(this.contentItems[s],!1)}this._header.removeTab(n),super.removeChild(n,t),o||this._header.updateClosability(),this.emitStateChangedEvent()}toggleMaximise(){this.isMaximised?this.minimise():this.maximise()}maximise(){if(!this.isMaximised){this.layoutManager.setMaximisedStack(this);const e=this.contentItems,t=e.length;for(let n=0;n<t;n++){const i=e[n];if(i instanceof le)i.enterStackMaximised();else throw new S("SMAXI87773")}this.emitStateChangedEvent()}}minimise(){if(this.isMaximised){this.layoutManager.setMaximisedStack(void 0);const e=this.contentItems,t=e.length;for(let n=0;n<t;n++){const i=e[n];if(i instanceof le)i.exitStackMaximised();else throw new S("SMINI87773")}this.emitStateChangedEvent()}}destroy(){var e;!((e=this._activeComponentItem)===null||e===void 0)&&e.focused&&this._activeComponentItem.blur(),super.destroy(),this.off("resize",this._resizeListener),this._maximisedEnabled&&(this.off("maximised",this._maximisedListener),this.off("minimised",this._minimisedListener)),this._header.destroy()}toConfig(){let e;if(this._activeComponentItem&&(e=this.contentItems.indexOf(this._activeComponentItem),e<0))throw new Error("active component item not found in stack");if(this.contentItems.length>0&&e===void 0)throw new Error("expected non-empty stack to have an active component item");return{type:"stack",content:this.calculateConfigContent(),size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,isClosable:this.isClosable,maximised:this.isMaximised,header:this.createHeaderConfig(),activeItemIndex:e}}onDrop(e,t){if(this._dropSegment==="header"){if(this.resetHeaderDropZone(),this._dropIndex===void 0)throw new v("SODDI68990");this.addChild(e,this._dropIndex);return}if(this._dropSegment==="body"){this.addChild(e,0,!0);return}const n=this._dropSegment==="top"||this._dropSegment==="bottom",i=this._dropSegment==="left"||this._dropSegment==="right",o=this._dropSegment==="top"||this._dropSegment==="left",s=n&&this.stackParent.isColumn||i&&this.stackParent.isRow;if(e.isComponent){const a=K.createDefault();a.header=this.createHeaderConfig();const l=this.layoutManager.createAndInitContentItem(a,this);l.addChild(e),e=l}if(e.type===p.row||e.type===p.column){const a=K.createDefault();a.header=this.createHeaderConfig();const l=this.layoutManager.createContentItem(a,this);l.addChild(e),e=l}if(s){const a=this.stackParent.contentItems.indexOf(this);this.stackParent.addChild(e,o?a:a+1,!0),this.size*=.5,e.size=this.size,e.sizeUnit=this.sizeUnit,this.stackParent.updateSize(!1)}else{const a=n?p.column:p.row,l=w.createDefault(a),d=this.layoutManager.createContentItem(l,this);this.stackParent.replaceChild(this,d),d.addChild(e,o?0:void 0,!0),d.addChild(this,o?void 0:0,!0),this.size=50,e.size=50,e.sizeUnit=E.Percent,d.updateSize(!1)}}highlightDropZone(e,t){for(const n in this._contentAreaDimensions){const i=n,o=this._contentAreaDimensions[i].hoverArea;if(o.x1<e&&o.x2>e&&o.y1<t&&o.y2>t){i==="header"?(this._dropSegment="header",this.highlightHeaderDropZone(this._header.leftRightSided?t:e)):(this.resetHeaderDropZone(),this.highlightBodyDropZone(i));return}}}getArea(){if(this.element.style.display==="none")return null;const e=super.getElementArea(this._header.element),t=super.getElementArea(this._childElementContainer);if(e===null||t===null)throw new L("SGAHC13086");const n=t.x2-t.x1,i=t.y2-t.y1;return this._contentAreaDimensions={header:{hoverArea:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},highlightArea:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}}},this.contentItems.length===0?(this._contentAreaDimensions.body={hoverArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2},highlightArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}},super.getElementArea(this.element)):(this._contentAreaDimensions.left={hoverArea:{x1:t.x1,y1:t.y1,x2:t.x1+n*.25,y2:t.y2},highlightArea:{x1:t.x1,y1:t.y1,x2:t.x1+n*.5,y2:t.y2}},this._contentAreaDimensions.top={hoverArea:{x1:t.x1+n*.25,y1:t.y1,x2:t.x1+n*.75,y2:t.y1+i*.5},highlightArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y1+i*.5}},this._contentAreaDimensions.right={hoverArea:{x1:t.x1+n*.75,y1:t.y1,x2:t.x2,y2:t.y2},highlightArea:{x1:t.x1+n*.5,y1:t.y1,x2:t.x2,y2:t.y2}},this._contentAreaDimensions.bottom={hoverArea:{x1:t.x1+n*.25,y1:t.y1+i*.5,x2:t.x1+n*.75,y2:t.y2},highlightArea:{x1:t.x1,y1:t.y1+i*.5,x2:t.x2,y2:t.y2}},super.getElementArea(this.element))}positionHeader(e){this._header.side!==e&&(this._header.setSide(e),this._headerSideChanged=!0,this.setupHeaderPosition())}updateNodeSize(){if(this.element.style.display!=="none"){const e=ne(this.element);if(this._header.show){const t=this._header.leftRightSided?Fe.width:Fe.height;e[t]-=this.layoutManager.layoutConfig.dimensions.headerHeight}this._childElementContainer.style.width=I(e.width),this._childElementContainer.style.height=I(e.height);for(let t=0;t<this.contentItems.length;t++)this.contentItems[t].element.style.width=I(e.width),this.contentItems[t].element.style.height=I(e.height);this.emit("resize"),this.emitStateChangedEvent()}}highlightHeaderDropZone(e){const t=this._header.lastVisibleTabIndex+1,i=this._header.tabsContainerElement.childNodes,o=new Array(t);let s=0,a=0;for(;a<t;){const c=i[s++];c!==this.layoutManager.tabDropPlaceholder&&(o[a++]=c)}const l=this.layoutManager.dropTargetIndicator;if(l===null)throw new L("SHHDZDTI97110");let d;if(t===0){const c=this._header.element.getBoundingClientRect(),u=c.top+document.body.scrollTop,m=c.left+document.body.scrollLeft;d={x1:m,x2:m+100,y1:u+c.height-20,y2:u+c.height},this._dropIndex=0}else{let c=0,u=!1,m,h,f,g;do{g=o[c];const k=g.getBoundingClientRect(),F=k.top+document.body.scrollTop,M=k.left+document.body.scrollLeft;this._header.leftRightSided?(h=F,m=M,f=k.height):(h=M,m=F,f=k.width),e>=h&&e<h+f?u=!0:c++}while(c<t&&!u);if(u===!1&&e<h)return;const y=h+f/2;e<y?(this._dropIndex=c,g.insertAdjacentElement("beforebegin",this.layoutManager.tabDropPlaceholder)):(this._dropIndex=Math.min(c+1,t),g.insertAdjacentElement("afterend",this.layoutManager.tabDropPlaceholder));const b=this.layoutManager.tabDropPlaceholder.getBoundingClientRect(),x=b.top+document.body.scrollTop,A=b.left+document.body.scrollLeft,P=b.width;if(this._header.leftRightSided){const k=x;d={x1:m,x2:m+g.clientHeight,y1:k,y2:k+P}}else{const k=A;d={x1:k,x2:k+P,y1:m,y2:m+g.clientHeight}}}l.highlightArea(d,0)}resetHeaderDropZone(){this.layoutManager.tabDropPlaceholder.remove()}setupHeaderPosition(){ie(this._header.element,this._header.show),this.element.classList.remove("lm_left","lm_right","lm_bottom"),this._header.leftRightSided&&this.element.classList.add("lm_"+this._header.side),this.updateSize(!1)}highlightBodyDropZone(e){if(this._contentAreaDimensions===void 0)throw new v("SHBDZC82265");{const t=this._contentAreaDimensions[e].highlightArea,n=this.layoutManager.dropTargetIndicator;if(n===null)throw new L("SHBDZD96110");n.highlightArea(t,1),this._dropSegment=e}}handleResize(){this._header.updateTabSizes()}handleMaximised(){this._header.processMaximised()}handleMinimised(){this._header.processMinimised()}handlePopoutEvent(){this.popout()}handleHeaderClickEvent(e){const t=z.headerClickEventName,n=new z.ClickBubblingEvent(t,this,e);this.emit(t,n)}handleHeaderTouchStartEvent(e){const t=z.headerTouchStartEventName,n=new z.TouchStartBubblingEvent(t,this,e);this.emit(t,n)}handleHeaderComponentRemoveEvent(e){this.removeChild(e,!1)}handleHeaderComponentFocusEvent(e){this.setActiveComponentItem(e,!0)}handleHeaderComponentStartDragEvent(e,t,n,i){this.isMaximised===!0&&this.toggleMaximise(),this.layoutManager.startComponentDrag(e,t,n,i,this)}createHeaderConfig(){if(this._headerSideChanged){const e=this._header.show?this._header.side:!1;let t=G.Header.createCopy(this._headerConfig,e);return t===void 0&&(t={show:e,popout:void 0,maximise:void 0,close:void 0,minimise:void 0,tabDropdown:void 0}),t}else return G.Header.createCopy(this._headerConfig)}emitStateChangedEvent(){this.emitBaseBubblingEvent("stateChanged")}}(function(r){function e(t){const n=t.createElement("div");return n.classList.add("lm_item"),n.classList.add("lm_stack"),n}r.createElement=e})(J||(J={}));class at extends z{constructor(e,t,n,i,o,s){if(super(),this._dragListener=n,this._layoutManager=i,this._componentItem=o,this._originalParent=s,this._area=null,this._lastValidArea=null,this._dragListener.on("drag",(a,l,d)=>this.onDrag(a,l,d)),this._dragListener.on("dragStop",()=>this.onDrop()),this.createDragProxyElements(e,t),this._componentItem.parent===null)throw new L("DPC10097");this._componentItemFocused=this._componentItem.focused,this._componentItemFocused&&this._componentItem.blur(),this._componentItem.parent.removeChild(this._componentItem,!0),this.setDimensions(),document.body.appendChild(this._element),this.determineMinMaxXY(),this._layoutManager.calculateItemAreas(),this.setDropPosition(e,t)}get element(){return this._element}createDragProxyElements(e,t){this._element=document.createElement("div"),this._element.classList.add("lm_dragProxy");const n=document.createElement("div");n.classList.add("lm_header");const i=document.createElement("div");i.classList.add("lm_tabs");const o=document.createElement("div");o.classList.add("lm_tab");const s=document.createElement("span");s.classList.add("lm_title"),o.appendChild(s),i.appendChild(o),n.appendChild(i),this._proxyContainerElement=document.createElement("div"),this._proxyContainerElement.classList.add("lm_content"),this._element.appendChild(n),this._element.appendChild(this._proxyContainerElement),this._originalParent instanceof J&&this._originalParent.headerShow&&(this._sided=this._originalParent.headerLeftRightSided,this._element.classList.add("lm_"+this._originalParent.headerSide),[oe.right,oe.bottom].indexOf(this._originalParent.headerSide)>=0&&this._proxyContainerElement.insertAdjacentElement("afterend",n)),this._element.style.left=I(e),this._element.style.top=I(t),o.setAttribute("title",this._componentItem.title),s.insertAdjacentText("afterbegin",this._componentItem.title),this._proxyContainerElement.appendChild(this._componentItem.element)}determineMinMaxXY(){const e=this._layoutManager.groundItem;if(e===void 0)throw new v("DPDMMXY73109");{const n=e.element.getBoundingClientRect();this._minX=n.left+document.body.scrollLeft,this._minY=n.top+document.body.scrollTop,this._maxX=this._minX+n.width,this._maxY=this._minY+n.height}}onDrag(e,t,n){const i=n.pageX,o=n.pageY;this.setDropPosition(i,o),this._componentItem.drag()}setDropPosition(e,t){this._layoutManager.layoutConfig.settings.constrainDragToContainer&&(e<=this._minX?e=Math.ceil(this._minX):e>=this._maxX&&(e=Math.floor(this._maxX)),t<=this._minY?t=Math.ceil(this._minY):t>=this._maxY&&(t=Math.floor(this._maxY))),this._element.style.left=I(e),this._element.style.top=I(t),this._area=this._layoutManager.getArea(e,t),this._area!==null&&(this._lastValidArea=this._area,this._area.contentItem.highlightDropZone(e,t,this._area))}onDrop(){const e=this._layoutManager.dropTargetIndicator;if(e===null)throw new L("DPOD30011");e.hide(),this._componentItem.exitDragMode();let t;this._area!==null?(t=this._componentItem,this._area.contentItem.onDrop(t,this._area)):this._lastValidArea!==null?(t=this._componentItem,this._lastValidArea.contentItem.onDrop(t,this._lastValidArea)):this._originalParent?(t=this._componentItem,this._originalParent.addChild(t)):this._componentItem.destroy(),this._element.remove(),this._layoutManager.emit("itemDropped",this._componentItem),this._componentItemFocused&&t!==void 0&&t.focus()}setDimensions(){const e=this._layoutManager.layoutConfig.dimensions;if(e===void 0)throw new Error("DragProxy.setDimensions: dimensions undefined");let t=e.dragProxyWidth,n=e.dragProxyHeight;if(t===void 0||n===void 0)throw new Error("DragProxy.setDimensions: width and/or height undefined");const i=this._layoutManager.layoutConfig.header.show===!1?0:e.headerHeight;this._element.style.width=I(t),this._element.style.height=I(n),t-=this._sided?i:0,n-=this._sided?0:i,this._proxyContainerElement.style.width=I(t),this._proxyContainerElement.style.height=I(n),this._componentItem.enterDragMode(t,n),this._componentItem.show()}}class Be{constructor(e,t,n,i,o,s,a){this._layoutManager=e,this._element=t,this._extraAllowableChildTargets=n,this._componentTypeOrFtn=i,this._componentState=o,this._title=s,this._id=a,this._dragListener=null,this._dummyGroundContainer=document.createElement("div");const l=we.createDefault("row");this._dummyGroundContentItem=new re(this._layoutManager,l,this._dummyGroundContainer),this.createDragListener()}destroy(){this.removeDragListener()}createDragListener(){this.removeDragListener(),this._dragListener=new et(this._element,this._extraAllowableChildTargets),this._dragListener.on("dragStart",(e,t)=>this.onDragStart(e,t)),this._dragListener.on("dragStop",()=>this.onDragStop())}onDragStart(e,t){var n;const i="component";let o;if(typeof this._componentTypeOrFtn=="function"){const l=this._componentTypeOrFtn();Be.isDragSourceComponentItemConfig(l)?o={type:i,componentState:l.state,componentType:l.type,title:(n=l.title)!==null&&n!==void 0?n:this._title}:o=l}else o={type:i,componentState:this._componentState,componentType:this._componentTypeOrFtn,title:this._title,id:this._id};const s=se.resolve(o,!1),a=new le(this._layoutManager,s,this._dummyGroundContentItem);if(this._dummyGroundContentItem.contentItems.push(a),this._dragListener===null)throw new L("DSODSD66746");{const l=new at(e,t,this._dragListener,this._layoutManager,a,this._dummyGroundContentItem),d=this._layoutManager.transitionIndicator;if(d===null)throw new L("DSODST66746");d.transitionElements(this._element,l.element)}}onDragStop(){this.createDragListener()}removeDragListener(){this._dragListener!==null&&(this._dragListener.destroy(),this._dragListener=null)}}(function(r){function e(t){return!("componentType"in t)}r.isDragSourceComponentItemConfig=e})(Be||(Be={}));class At{constructor(){this._element=document.createElement("div"),this._element.classList.add("lm_dropTargetIndicator");const e=document.createElement("div");e.classList.add("lm_inner"),this._element.appendChild(e),document.body.appendChild(this._element)}destroy(){this._element.remove()}highlightArea(e,t){this._element.style.left=I(e.x1+t),this._element.style.top=I(e.y1+t),this._element.style.width=I(e.x2-e.x1-t),this._element.style.height=I(e.y2-e.y1-t),this._element.style.display="block"}hide(){ie(this._element,!1)}}class Pt{constructor(){this._element=document.createElement("div"),this._element.classList.add("lm_transition_indicator"),document.body.appendChild(this._element),this._toElement=null,this._fromDimensions=null,this._totalAnimationDuration=200,this._animationStartTime=null}destroy(){this._element.remove()}transitionElements(e,t){}nextAnimationFrame(){}measure(e){const t=e.getBoundingClientRect();return{left:t.left,top:t.top,width:e.offsetWidth,height:e.offsetHeight}}}class ce extends z{constructor(e){super(),this._layoutManager=e,this._childEventListener=t=>this.onEventFromChild(t),globalThis.addEventListener(ce.ChildEventName,this._childEventListener,{passive:!0})}emit(e,...t){e==="userBroadcast"?this.emitUserBroadcast(...t):super.emit(e,...t)}emitUserBroadcast(...e){this.handleUserBroadcastEvent("userBroadcast",e)}destroy(){globalThis.removeEventListener(ce.ChildEventName,this._childEventListener)}handleUserBroadcastEvent(e,t){this._layoutManager.isSubWindow?this.propagateToParent(e,t):this.propagateToThisAndSubtree(e,t)}onEventFromChild(e){const t=e.detail;this.handleUserBroadcastEvent(t.eventName,t.args)}propagateToParent(e,t){const i={bubbles:!0,cancelable:!0,detail:{layoutManager:this._layoutManager,eventName:e,args:t}},o=new CustomEvent(ce.ChildEventName,i),s=globalThis.opener;if(s===null)throw new L("EHPTP15778");s.dispatchEvent(o)}propagateToThisAndSubtree(e,t){this.emitUnknown(e,...t);for(let n=0;n<this._layoutManager.openPopouts.length;n++){const i=this._layoutManager.openPopouts[n].getGlInstance();i&&i.eventHub.propagateToThisAndSubtree(e,t)}}}(function(r){r.ChildEventName="gl_child_event"})(ce||(ce={}));class he extends z{constructor(e){super(),this.resizeWithContainerAutomatically=!1,this.resizeDebounceInterval=100,this.resizeDebounceExtendedWhenPossible=!0,this._isInitialised=!1,this._groundItem=void 0,this._openPopouts=[],this._dropTargetIndicator=null,this._transitionIndicator=null,this._itemAreas=[],this._maximisePlaceholder=he.createMaximisePlaceElement(document),this._tabDropPlaceholder=he.createTabDropPlaceholderElement(document),this._dragSources=[],this._updatingColumnsResponsive=!1,this._firstLoad=!0,this._eventHub=new ce(this),this._width=null,this._height=null,this._virtualSizedContainers=[],this._virtualSizedContainerAddingBeginCount=0,this._sizeInvalidationBeginCount=0,this._resizeObserver=new ResizeObserver(()=>this.handleContainerResize()),this._windowBeforeUnloadListener=()=>this.onBeforeUnload(),this._windowBeforeUnloadListening=!1,this._maximisedStackBeforeDestroyedListener=t=>this.cleanupBeforeMaximisedStackDestroyed(t),this.isSubWindow=e.isSubWindow,this._constructorOrSubWindowLayoutConfig=e.constructorOrSubWindowLayoutConfig,Ve.checkInitialise(),ze.checkInitialise(),e.containerElement!==void 0&&(this._containerElement=e.containerElement)}get container(){return this._containerElement}get isInitialised(){return this._isInitialised}get groundItem(){return this._groundItem}get root(){return this._groundItem}get openPopouts(){return this._openPopouts}get dropTargetIndicator(){return this._dropTargetIndicator}get transitionIndicator(){return this._transitionIndicator}get width(){return this._width}get height(){return this._height}get eventHub(){return this._eventHub}get rootItem(){if(this._groundItem===void 0)throw new Error("Cannot access rootItem before init");return this._groundItem.contentItems.length===0?void 0:this._groundItem.contentItems[0]}get focusedComponentItem(){return this._focusedComponentItem}get tabDropPlaceholder(){return this._tabDropPlaceholder}get maximisedStack(){return this._maximisedStack}get deprecatedConstructor(){return!this.isSubWindow&&this._constructorOrSubWindowLayoutConfig!==void 0}destroy(){if(this._isInitialised){this._windowBeforeUnloadListening&&(globalThis.removeEventListener("beforeunload",this._windowBeforeUnloadListener),this._windowBeforeUnloadListening=!1),this.layoutConfig.settings.closePopoutsOnUnload===!0&&this.closeAllOpenPopouts(),this._resizeObserver.disconnect(),this.checkClearResizeTimeout(),this._groundItem!==void 0&&this._groundItem.destroy(),this._tabDropPlaceholder.remove(),this._dropTargetIndicator!==null&&this._dropTargetIndicator.destroy(),this._transitionIndicator!==null&&this._transitionIndicator.destroy(),this._eventHub.destroy();for(const e of this._dragSources)e.destroy();this._dragSources=[],this._isInitialised=!1}}minifyConfig(e){return C.minifyConfig(e)}unminifyConfig(e){return C.unminifyConfig(e)}init(){this.setContainer(),this._dropTargetIndicator=new At,this._transitionIndicator=new Pt,this.updateSizeFromContainer();let e;if(this.isSubWindow){if(this._constructorOrSubWindowLayoutConfig===void 0)throw new v("LMIU07155");{const n=this._constructorOrSubWindowLayoutConfig.root;if(n===void 0)throw new S("LMIC07156");if(R.isComponent(n))e=n;else throw new S("LMIC07157");const i=U.resolve(this._constructorOrSubWindowLayoutConfig);this.layoutConfig=Object.assign(Object.assign({},i),{root:void 0})}}else this._constructorOrSubWindowLayoutConfig===void 0?this.layoutConfig=C.createDefault():this.layoutConfig=U.resolve(this._constructorOrSubWindowLayoutConfig);const t=this.layoutConfig;this._groundItem=new re(this,t.root,this._containerElement),this._groundItem.init(),this.checkLoadedLayoutMaximiseItem(),this._resizeObserver.observe(this._containerElement),this._isInitialised=!0,this.adjustColumnsResponsive(),this.emit("initialised"),e!==void 0&&this.loadComponentAsRoot(e)}loadLayout(e){if(this.isInitialised){if(this._groundItem===void 0)throw new v("LMLL11119");this.createSubWindows(),this.layoutConfig=U.resolve(e),this._groundItem.loadRoot(this.layoutConfig.root),this.checkLoadedLayoutMaximiseItem(),this.adjustColumnsResponsive()}else throw new Error("GoldenLayout: Need to call init() if LayoutConfig with defined root passed to constructor")}saveLayout(){if(this._isInitialised===!1)throw new Error("Can't create config, layout not yet initialised");if(this._groundItem===void 0)throw new v("LMTC18244");{const e=this._groundItem.calculateConfigContent();let t;e.length!==1?t=void 0:t=e[0],this.reconcilePopoutWindows();const n=[];for(let o=0;o<this._openPopouts.length;o++)n.push(this._openPopouts[o].toConfig());return{root:t,openPopouts:n,settings:C.Settings.createCopy(this.layoutConfig.settings),dimensions:C.Dimensions.createCopy(this.layoutConfig.dimensions),header:C.Header.createCopy(this.layoutConfig.header),resolved:!0}}}clear(){if(this._groundItem===void 0)throw new v("LMCL11129");this._groundItem.clearRoot()}toConfig(){return this.saveLayout()}newComponent(e,t,n){const i=this.newComponentAtLocation(e,t,n);if(i===void 0)throw new S("LMNC65588");return i}newComponentAtLocation(e,t,n,i){if(this._groundItem===void 0)throw new Error("Cannot add component before init");{const o=this.addComponentAtLocation(e,t,n,i);if(o===void 0)return;{const s=o.parentItem.contentItems[o.index];if(N.isComponentItem(s))return s;throw new S("LMNC992877533")}}}addComponent(e,t,n){const i=this.addComponentAtLocation(e,t,n);if(i===void 0)throw new S("LMAC99943");return i}addComponentAtLocation(e,t,n,i){const o={type:"component",componentType:e,componentState:t,title:n};return this.addItemAtLocation(o,i)}newItem(e){const t=this.newItemAtLocation(e);if(t===void 0)throw new S("LMNC65588");return t}newItemAtLocation(e,t){if(this._groundItem===void 0)throw new Error("Cannot add component before init");{const n=this.addItemAtLocation(e,t);return n===void 0?void 0:n.parentItem.contentItems[n.index]}}addItem(e){const t=this.addItemAtLocation(e);if(t===void 0)throw new S("LMAI99943");return t}addItemAtLocation(e,t){if(this._groundItem===void 0)throw new Error("Cannot add component before init");{t===void 0&&(t=he.defaultLocationSelectors);const n=this.findFirstLocation(t);if(n===void 0)return;{let i=n.parentItem,o;switch(i.type){case p.ground:{o=i.addItem(e,n.index),o>=0?i=this._groundItem.contentItems[0]:o=0;break}case p.row:case p.column:{o=i.addItem(e,n.index);break}case p.stack:if(R.isComponent(e)){o=i.addItem(e,n.index);break}else throw Error(D[6]);case p.component:throw new S("LMAIALC87444602");default:throw new $("LMAIALU98881733",i.type)}if(R.isComponent(e)){const s=i.contentItems[o];N.isStack(s)&&(i=s,o=0)}return n.parentItem=i,n.index=o,n}}}loadComponentAsRoot(e){if(this._groundItem===void 0)throw new Error("Cannot add item before init");this._groundItem.loadComponentAsRoot(e)}updateSize(e,t){this.setSize(e,t)}setSize(e,t){if(this._width=e,this._height=t,this._isInitialised===!0){if(this._groundItem===void 0)throw new v("LMUS18881");if(this._groundItem.setSize(this._width,this._height),this._maximisedStack){const{width:n,height:i}=ne(this._containerElement);W(this._maximisedStack.element,n),O(this._maximisedStack.element,i),this._maximisedStack.updateSize(!1)}this.adjustColumnsResponsive()}}beginSizeInvalidation(){this._sizeInvalidationBeginCount++}endSizeInvalidation(){--this._sizeInvalidationBeginCount===0&&this.updateSizeFromContainer()}updateSizeFromContainer(){const{width:e,height:t}=ne(this._containerElement);this.setSize(e,t)}updateRootSize(e=!1){if(this._groundItem===void 0)throw new v("LMURS28881");this._groundItem.updateSize(e)}createAndInitContentItem(e,t){const n=this.createContentItem(e,t);return n.init(),n}createContentItem(e,t){if(typeof e.type!="string")throw new de("Missing parameter 'type'",JSON.stringify(e));return w.isComponentItem(e)&&!(t instanceof J)&&t&&!(this.isSubWindow===!0&&t instanceof re)&&(e={type:p.stack,content:[e],size:e.size,sizeUnit:e.sizeUnit,minSize:e.minSize,minSizeUnit:e.minSizeUnit,id:e.id,maximised:e.maximised,isClosable:e.isClosable,activeItemIndex:0,header:void 0}),this.createContentItemFromConfig(e,t)}findFirstComponentItemById(e){if(this._groundItem===void 0)throw new v("LMFFCIBI82446");return this.findFirstContentItemTypeByIdRecursive(p.component,e,this._groundItem)}createPopout(e,t,n,i){return e instanceof N?this.createPopoutFromContentItem(e,t,n,i):this.createPopoutFromItemConfig(e,t,n,i)}createPopoutFromContentItem(e,t,n,i){let o=e.parent,s=e;for(;o!==null&&o.contentItems.length===1&&!o.isGround;)s=o,o=o.parent;if(o===null)throw new L("LMCPFCI00834");{if(i===void 0&&(i=o.contentItems.indexOf(s)),n!==null&&o.addPopInParentId(n),t===void 0){const l=globalThis.screenX||globalThis.screenLeft,d=globalThis.screenY||globalThis.screenTop,c=e.element.offsetLeft,u=e.element.offsetTop,{width:m,height:h}=ne(e.element);t={left:l+c,top:d+u,width:m,height:h}}const a=e.toConfig();if(e.remove(),ue.isRootItemConfig(a))return this.createPopoutFromItemConfig(a,t,n,i);throw new Error(`${D[0]}`)}}beginVirtualSizedContainerAdding(){++this._virtualSizedContainerAddingBeginCount===0&&(this._virtualSizedContainers.length=0)}addVirtualSizedContainer(e){this._virtualSizedContainers.push(e)}endVirtualSizedContainerAdding(){if(--this._virtualSizedContainerAddingBeginCount===0){const e=this._virtualSizedContainers.length;if(e>0){this.fireBeforeVirtualRectingEvent(e);for(let t=0;t<e;t++)this._virtualSizedContainers[t].notifyVirtualRectingRequired();this.fireAfterVirtualRectingEvent(),this._virtualSizedContainers.length=0}}}fireBeforeVirtualRectingEvent(e){this.beforeVirtualRectingEvent!==void 0&&this.beforeVirtualRectingEvent(e)}fireAfterVirtualRectingEvent(){this.afterVirtualRectingEvent!==void 0&&this.afterVirtualRectingEvent()}createPopoutFromItemConfig(e,t,n,i){const o=this.toConfig(),s={root:e,openPopouts:[],settings:o.settings,dimensions:o.dimensions,header:o.header,window:t,parentId:n,indexInParent:i,resolved:!0};return this.createPopoutFromPopoutLayoutConfig(s)}createPopoutFromPopoutLayoutConfig(e){var t,n,i,o;const s=e.window,a={left:(t=s.left)!==null&&t!==void 0?t:globalThis.screenX||globalThis.screenLeft+20,top:(n=s.top)!==null&&n!==void 0?n:globalThis.screenY||globalThis.screenTop+20,width:(i=s.width)!==null&&i!==void 0?i:500,height:(o=s.height)!==null&&o!==void 0?o:309},l=new Tt(e,a,this);return l.on("initialised",()=>this.emit("windowOpened",l)),l.on("closed",()=>this.reconcilePopoutWindows()),this._openPopouts.push(l),this.layoutConfig.settings.closePopoutsOnUnload&&!this._windowBeforeUnloadListening&&(globalThis.addEventListener("beforeunload",this._windowBeforeUnloadListener,{passive:!0}),this._windowBeforeUnloadListening=!0),l}closeAllOpenPopouts(){for(let e=0;e<this._openPopouts.length;e++)this._openPopouts[e].close();this._openPopouts.length=0,this._windowBeforeUnloadListening&&(globalThis.removeEventListener("beforeunload",this._windowBeforeUnloadListener),this._windowBeforeUnloadListening=!1)}newDragSource(e,t,n,i,o){const s=new Be(this,e,[],t,n,i,o);return this._dragSources.push(s),s}removeDragSource(e){Et(e,this._dragSources),e.destroy()}startComponentDrag(e,t,n,i,o){new at(e,t,n,this,i,o)}focusComponent(e,t=!1){e.focus(t)}clearComponentFocus(e=!1){this.setFocusedComponentItem(void 0,e)}setFocusedComponentItem(e,t=!1){if(e!==this._focusedComponentItem){let n;if(e===void 0||(n=e.parentItem),this._focusedComponentItem!==void 0){const i=this._focusedComponentItem;this._focusedComponentItem=void 0,i.setBlurred(t);const o=i.parentItem;n===o?n=void 0:o.setFocusedValue(!1)}e!==void 0&&(this._focusedComponentItem=e,e.setFocused(t),n!==void 0&&n.setFocusedValue(!0))}}createContentItemFromConfig(e,t){switch(e.type){case p.ground:throw new S("LMCCIFC68871");case p.row:return new me(!1,this,e,t);case p.column:return new me(!0,this,e,t);case p.stack:return new J(this,e,t);case p.component:return new le(this,e,t);default:throw new $("CCC913564",e.type,"Invalid Config Item type specified")}}setMaximisedStack(e){e===void 0?this._maximisedStack!==void 0&&this.processMinimiseMaximisedStack():e!==this._maximisedStack&&(this._maximisedStack!==void 0&&this.processMinimiseMaximisedStack(),this.processMaximiseStack(e))}checkMinimiseMaximisedStack(){this._maximisedStack!==void 0&&this._maximisedStack.minimise()}cleanupBeforeMaximisedStackDestroyed(e){this._maximisedStack!==null&&this._maximisedStack===e.target&&(this._maximisedStack.off("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),this._maximisedStack=void 0)}closeWindow(){globalThis.setTimeout(()=>globalThis.close(),1)}getArea(e,t){let n=null,i=1/0;for(let o=0;o<this._itemAreas.length;o++){const s=this._itemAreas[o];e>=s.x1&&e<s.x2&&t>=s.y1&&t<s.y2&&i>s.surface&&(i=s.surface,n=s)}return n}calculateItemAreas(){const e=this.getAllContentItems(),t=this._groundItem;if(t===void 0)throw new v("LMCIAR44365");if(e.length===1){const n=t.getElementArea();if(n===null)throw new L("LMCIARA44365");this._itemAreas=[n];return}else{t.contentItems[0].isStack?this._itemAreas=[]:this._itemAreas=t.createSideAreas();for(let n=0;n<e.length;n++){const i=e[n];if(N.isStack(i)){const o=i.getArea();if(o===null)continue;{this._itemAreas.push(o);const s=i.contentAreaDimensions;if(s===void 0)throw new v("LMCIASC45599");{const a=s.header.highlightArea,l=(a.x2-a.x1)*(a.y2-a.y1),d={x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2,contentItem:i,surface:l};this._itemAreas.push(d)}}}}}}checkLoadedLayoutMaximiseItem(){if(this._groundItem===void 0)throw new v("LMCLLMI43432");{const e=this._groundItem.getConfigMaximisedItems();if(e.length>0){let t=e[0];if(N.isComponentItem(t)){const n=t.parent;if(n===null)throw new L("LMXLLMI69999");t=n}if(N.isStack(t))t.maximise();else throw new S("LMCLLMI19993")}}}processMaximiseStack(e){if(this._maximisedStack=e,e.on("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),e.element.classList.add("lm_maximised"),e.element.insertAdjacentElement("afterend",this._maximisePlaceholder),this._groundItem===void 0)throw new v("LMMXI19993");{this._groundItem.element.prepend(e.element);const{width:t,height:n}=ne(this._containerElement);W(e.element,t),O(e.element,n),e.updateSize(!0),e.focusActiveContentItem(),this._maximisedStack.emit("maximised"),this.emit("stateChanged")}}processMinimiseMaximisedStack(){if(this._maximisedStack===void 0)throw new S("LMMMS74422");{const e=this._maximisedStack;if(e.parent===null)throw new L("LMMI13668");e.element.classList.remove("lm_maximised"),this._maximisePlaceholder.insertAdjacentElement("afterend",e.element),this._maximisePlaceholder.remove(),this.updateRootSize(!0),this._maximisedStack=void 0,e.off("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),e.emit("minimised"),this.emit("stateChanged")}}reconcilePopoutWindows(){const e=[];for(let t=0;t<this._openPopouts.length;t++)this._openPopouts[t].getWindow().closed===!1?e.push(this._openPopouts[t]):this.emit("windowClosed",this._openPopouts[t]);this._openPopouts.length!==e.length&&(this._openPopouts=e,this.emit("stateChanged"))}getAllContentItems(){if(this._groundItem===void 0)throw new v("LMGACI13130");return this._groundItem.getAllContentItems()}createSubWindows(){for(let e=0;e<this.layoutConfig.openPopouts.length;e++){const t=this.layoutConfig.openPopouts[e];this.createPopoutFromPopoutLayoutConfig(t)}}handleContainerResize(){this.resizeWithContainerAutomatically&&this.processResizeWithDebounce()}processResizeWithDebounce(){this.resizeDebounceExtendedWhenPossible&&this.checkClearResizeTimeout(),this._resizeTimeoutId===void 0&&(this._resizeTimeoutId=setTimeout(()=>{this._resizeTimeoutId=void 0,this.beginSizeInvalidation(),this.endSizeInvalidation()},this.resizeDebounceInterval))}checkClearResizeTimeout(){this._resizeTimeoutId!==void 0&&(clearTimeout(this._resizeTimeoutId),this._resizeTimeoutId=void 0)}setContainer(){var e;const t=document.body,n=(e=this._containerElement)!==null&&e!==void 0?e:t;if(n===t){this.resizeWithContainerAutomatically=!0;const i=document.documentElement;i.style.height="100%",i.style.margin="0",i.style.padding="0",i.style.overflow="clip",t.style.height="100%",t.style.margin="0",t.style.padding="0",t.style.overflow="clip"}this._containerElement=n}onBeforeUnload(){this.destroy()}adjustColumnsResponsive(){if(this._groundItem===void 0)throw new v("LMACR20883");if(this._firstLoad=!1,this.useResponsiveLayout()&&!this._updatingColumnsResponsive&&this._groundItem.contentItems.length>0&&this._groundItem.contentItems[0].isRow){if(this._groundItem===void 0||this._width===null)throw new v("LMACR77412");{const e=this._groundItem.contentItems[0].contentItems.length;if(e<=1)return;{const t=this.layoutConfig.dimensions.defaultMinItemWidth;if(e*t<=this._width)return;{this._updatingColumnsResponsive=!0;const i=Math.max(Math.floor(this._width/t),1),o=e-i,s=this._groundItem.contentItems[0],a=this.getAllStacks();if(a.length===0)throw new S("LMACRS77413");{const l=a[0];for(let d=0;d<o;d++){const c=s.contentItems[s.contentItems.length-1];this.addChildContentItemsToContainer(l,c)}this._updatingColumnsResponsive=!1}}}}}}useResponsiveLayout(){const e=this.layoutConfig.settings,t=e.responsiveMode===Re.always,n=e.responsiveMode===Re.onload&&this._firstLoad;return t||n}addChildContentItemsToContainer(e,t){const n=t.contentItems;if(t instanceof J)for(let i=0;i<n.length;i++){const o=n[i];t.removeChild(o,!0),e.addChild(o)}else for(let i=0;i<n.length;i++){const o=n[i];this.addChildContentItemsToContainer(e,o)}}getAllStacks(){if(this._groundItem===void 0)throw new v("LMFASC52778");{const e=[];return this.findAllStacksRecursive(e,this._groundItem),e}}findFirstContentItemType(e){if(this._groundItem===void 0)throw new v("LMFFCIT82446");return this.findFirstContentItemTypeRecursive(e,this._groundItem)}findFirstContentItemTypeRecursive(e,t){const n=t.contentItems,i=n.length;if(i!==0){for(let o=0;o<i;o++){const s=n[o];if(s.type===e)return s}for(let o=0;o<i;o++){const s=n[o],a=this.findFirstContentItemTypeRecursive(e,s);if(a!==void 0)return a}return}}findFirstContentItemTypeByIdRecursive(e,t,n){const i=n.contentItems,o=i.length;if(o!==0){for(let s=0;s<o;s++){const a=i[s];if(a.type===e&&a.id===t)return a}for(let s=0;s<o;s++){const a=i[s],l=this.findFirstContentItemTypeByIdRecursive(e,t,a);if(l!==void 0)return l}return}}findAllStacksRecursive(e,t){const n=t.contentItems;for(let i=0;i<n.length;i++){const o=n[i];o instanceof J?e.push(o):o.isComponent||this.findAllStacksRecursive(e,o)}}findFirstLocation(e){const t=e.length;for(let n=0;n<t;n++){const i=e[n],o=this.findLocation(i);if(o!==void 0)return o}}findLocation(e){const t=e.index;switch(e.typeId){case 0:{if(this._focusedComponentItem===void 0)return;{const n=this._focusedComponentItem.parentItem,i=n.contentItems,o=i.length;if(t===void 0)return{parentItem:n,index:o};{const a=i.indexOf(this._focusedComponentItem)+t;return a<0||a>o?void 0:{parentItem:n,index:a}}}}case 1:{if(this._focusedComponentItem===void 0)return;{const n=this._focusedComponentItem.parentItem;return this.tryCreateLocationFromParentItem(n,t)}}case 2:{const n=this.findFirstContentItemType(p.stack);return n===void 0?void 0:this.tryCreateLocationFromParentItem(n,t)}case 3:{let n=this.findFirstContentItemType(p.row);return n!==void 0?this.tryCreateLocationFromParentItem(n,t):(n=this.findFirstContentItemType(p.column),n!==void 0?this.tryCreateLocationFromParentItem(n,t):void 0)}case 4:{const n=this.findFirstContentItemType(p.row);return n===void 0?void 0:this.tryCreateLocationFromParentItem(n,t)}case 5:{const n=this.findFirstContentItemType(p.column);return n===void 0?void 0:this.tryCreateLocationFromParentItem(n,t)}case 6:{if(this._groundItem===void 0)throw new v("LMFLRIF18244");return this.rootItem!==void 0?void 0:t===void 0||t===0?{parentItem:this._groundItem,index:0}:void 0}case 7:{if(this._groundItem===void 0)throw new v("LMFLF18244");{const n=this._groundItem.contentItems;if(n.length===0)return t===void 0||t===0?{parentItem:this._groundItem,index:0}:void 0;{const i=n[0];return this.tryCreateLocationFromParentItem(i,t)}}}}}tryCreateLocationFromParentItem(e,t){const i=e.contentItems.length;return t===void 0?{parentItem:e,index:i}:t<0||t>i?void 0:{parentItem:e,index:t}}}(function(r){function e(n){const i=n.createElement("div");return i.classList.add("lm_maximise_place"),i}r.createMaximisePlaceElement=e;function t(n){const i=n.createElement("div");return i.classList.add("lm_drop_tab_placeholder"),i}r.createTabDropPlaceholderElement=t,r.defaultLocationSelectors=[{typeId:1,index:void 0},{typeId:2,index:void 0},{typeId:3,index:void 0},{typeId:7,index:void 0}],r.afterFocusedItemIfPossibleLocationSelectors=[{typeId:0,index:1},{typeId:2,index:void 0},{typeId:3,index:void 0},{typeId:7,index:void 0}]})(he||(he={}));class De extends he{constructor(e,t,n,i){if(super(De.createLayoutManagerConstructorParameters(e,t)),this._bindComponentEventHanlderPassedInConstructor=!1,this._creationTimeoutPassed=!1,t!==void 0&&typeof t=="function"&&(this.bindComponentEvent=t,this._bindComponentEventHanlderPassedInConstructor=!0,n!==void 0&&(this.unbindComponentEvent=n)),!this._bindComponentEventHanlderPassedInConstructor&&this.isSubWindow){if(this._constructorOrSubWindowLayoutConfig===void 0)throw new v("VLC98823");{const o=U.resolve(this._constructorOrSubWindowLayoutConfig);this.layoutConfig=Object.assign(Object.assign({},o),{root:void 0})}}i!==!0&&(this.deprecatedConstructor||this.init())}destroy(){this.bindComponentEvent=void 0,this.unbindComponentEvent=void 0,super.destroy()}init(){if(!this._bindComponentEventHanlderPassedInConstructor&&(document.readyState==="loading"||document.body===null)){document.addEventListener("DOMContentLoaded",()=>this.init(),{passive:!0});return}if(!this._bindComponentEventHanlderPassedInConstructor&&this.isSubWindow===!0&&!this._creationTimeoutPassed){setTimeout(()=>this.init(),7),this._creationTimeoutPassed=!0;return}this.isSubWindow===!0&&(this._bindComponentEventHanlderPassedInConstructor||this.clearHtmlAndAdjustStylesForSubWindow(),window.__glInstance=this),super.init()}clearHtmlAndAdjustStylesForSubWindow(){const e=document.head,t=new Array(4);t[0]=document.querySelectorAll("body link"),t[1]=document.querySelectorAll("body style"),t[2]=document.querySelectorAll("template"),t[3]=document.querySelectorAll(".gl_keep");for(let i=0;i<t.length;i++){const o=t[i];for(let s=0;s<o.length;s++){const a=o[s];e.appendChild(a)}}const n=document.body;n.innerHTML="",n.style.visibility="visible",this.checkAddDefaultPopinButton(),document.body.offsetHeight}checkAddDefaultPopinButton(){if(this.layoutConfig.settings.popInOnClose)return!1;{const e=document.createElement("div");e.classList.add("lm_popin"),e.setAttribute("title",this.layoutConfig.header.dock);const t=document.createElement("div");t.classList.add("lm_icon");const n=document.createElement("div");return n.classList.add("lm_bg"),e.appendChild(t),e.appendChild(n),e.addEventListener("click",()=>this.emit("popIn")),document.body.appendChild(e),!0}}bindComponent(e,t){if(this.bindComponentEvent!==void 0)return this.bindComponentEvent(e,t);if(this.getComponentEvent!==void 0)return{virtual:!1,component:this.getComponentEvent(e,t)};{const i=`${D[2]}: ${JSON.stringify(t)}`;throw new te(i)}}unbindComponent(e,t,n){if(this.unbindComponentEvent!==void 0)this.unbindComponentEvent(e);else if(!t&&this.releaseComponentEvent!==void 0){if(n===void 0)throw new v("VCUCRCU333998");this.releaseComponentEvent(e,n)}}}(function(r){let e=!1;function t(n,i){const o=e?null:new URL(document.location.href).searchParams.get("gl-window");e=!0;const s=o!==null;let a,l;if(o!==null){const d=localStorage.getItem(o);if(d===null)throw new Error("Null gl-window Config");localStorage.removeItem(o);const c=JSON.parse(d),u=C.unminifyConfig(c);l=U.fromResolved(u),n instanceof HTMLElement&&(a=n)}else n===void 0?l=void 0:n instanceof HTMLElement?(l=void 0,a=n):l=n,a===void 0&&i instanceof HTMLElement&&(a=i);return{constructorOrSubWindowLayoutConfig:l,isSubWindow:s,containerElement:a}}r.createLayoutManagerConstructorParameters=t})(De||(De={}));class Bt extends De{constructor(e,t,n){super(e,t,n,!0),this._componentTypesMap=new Map,this._registeredComponentMap=new Map,this._virtuableComponentMap=new Map,this._containerVirtualRectingRequiredEventListener=(i,o,s)=>this.handleContainerVirtualRectingRequiredEvent(i,o,s),this._containerVirtualVisibilityChangeRequiredEventListener=(i,o)=>this.handleContainerVirtualVisibilityChangeRequiredEvent(i,o),this._containerVirtualZIndexChangeRequiredEventListener=(i,o,s)=>this.handleContainerVirtualZIndexChangeRequiredEvent(i,o,s),this.deprecatedConstructor||this.init()}registerComponent(e,t,n=!1){if(typeof t!="function")throw new Ct("registerComponent() componentConstructorOrFactoryFtn parameter is not a function");if(t.hasOwnProperty("prototype")){const i=t;this.registerComponentConstructor(e,i,n)}else{const i=t;this.registerComponentFactoryFunction(e,i,n)}}registerComponentConstructor(e,t,n=!1){if(typeof t!="function")throw new Error(D[1]);if(this._componentTypesMap.get(e)!==void 0)throw new te(`${D[3]}: ${e}`);this._componentTypesMap.set(e,{constructor:t,factoryFunction:void 0,virtual:n})}registerComponentFactoryFunction(e,t,n=!1){if(typeof t!="function")throw new te("Please register a constructor function");if(this._componentTypesMap.get(e)!==void 0)throw new te(`${D[3]}: ${e}`);this._componentTypesMap.set(e,{constructor:void 0,factoryFunction:t,virtual:n})}registerComponentFunction(e){this.registerGetComponentConstructorCallback(e)}registerGetComponentConstructorCallback(e){if(typeof e!="function")throw new Error("Please register a callback function");this._getComponentConstructorFtn!==void 0&&console.warn("Multiple component functions are being registered.  Only the final registered function will be used."),this._getComponentConstructorFtn=e}getRegisteredComponentTypeNames(){const e=this._componentTypesMap.keys();return Array.from(e)}getComponentInstantiator(e){let t;const n=Q.resolveComponentTypeName(e);return n!==void 0&&(t=this._componentTypesMap.get(n)),t===void 0&&this._getComponentConstructorFtn!==void 0&&(t={constructor:this._getComponentConstructorFtn(e),factoryFunction:void 0,virtual:!1}),t}bindComponent(e,t){let n;const i=Q.resolveComponentTypeName(t);i!==void 0&&(n=this._componentTypesMap.get(i)),n===void 0&&this._getComponentConstructorFtn!==void 0&&(n={constructor:this._getComponentConstructorFtn(t),factoryFunction:void 0,virtual:!1});let o;if(n!==void 0){const s=n.virtual;let a;t.componentState===void 0?a=void 0:a=be({},t.componentState);let l;const d=n.constructor;if(d!==void 0)l=new d(e,a,s);else{const c=n.factoryFunction;if(c!==void 0)l=c(e,a,s);else throw new S("LMBCFFU10008")}if(s){if(l===void 0)throw new v("GLBCVCU988774");{const c=l,u=c.rootHtmlElement;if(u===void 0)throw new te(`${D[5]}: ${i}`);It(u),this.container.appendChild(u),this._virtuableComponentMap.set(e,c),e.virtualRectingRequiredEvent=this._containerVirtualRectingRequiredEventListener,e.virtualVisibilityChangeRequiredEvent=this._containerVirtualVisibilityChangeRequiredEventListener,e.virtualZIndexChangeRequiredEvent=this._containerVirtualZIndexChangeRequiredEventListener}}this._registeredComponentMap.set(e,l),o={virtual:n.virtual,component:l}}else o=super.bindComponent(e,t);return o}unbindComponent(e,t,n){if(this._registeredComponentMap.get(e)===void 0)super.unbindComponent(e,t,n);else{const o=this._virtuableComponentMap.get(e);if(o!==void 0){const s=o.rootHtmlElement;if(s===void 0)throw new S("GLUC77743",e.title);this.container.removeChild(s),this._virtuableComponentMap.delete(e)}}}fireBeforeVirtualRectingEvent(e){this._goldenLayoutBoundingClientRect=this.container.getBoundingClientRect(),super.fireBeforeVirtualRectingEvent(e)}handleContainerVirtualRectingRequiredEvent(e,t,n){const i=this._virtuableComponentMap.get(e);if(i===void 0)throw new v("GLHCSCE55933");{const o=i.rootHtmlElement;if(o===void 0)throw new te(D[4]+" "+e.title);{const s=e.element.getBoundingClientRect(),a=s.left-this._goldenLayoutBoundingClientRect.left;o.style.left=I(a);const l=s.top-this._goldenLayoutBoundingClientRect.top;o.style.top=I(l),W(o,t),O(o,n)}}}handleContainerVirtualVisibilityChangeRequiredEvent(e,t){const n=this._virtuableComponentMap.get(e);if(n===void 0)throw new v("GLHCVVCRE55934");{const i=n.rootHtmlElement;if(i===void 0)throw new te(D[4]+" "+e.title);ie(i,t)}}handleContainerVirtualZIndexChangeRequiredEvent(e,t,n){const i=this._virtuableComponentMap.get(e);if(i===void 0)throw new v("GLHCVZICRE55935");{const o=i.rootHtmlElement;if(o===void 0)throw new te(D[4]+" "+e.title);o.style.zIndex=n}}}class Ee{constructor(e,t){this._container=e,t?(this._rootElement=document.createElement("div"),this._rootElement.style.position="absolute",this._rootElement.style.overflow="hidden"):this._rootElement=this._container.element}_rootElement;get container(){return this._container}get rootHtmlElement(){return this._rootElement}}class Z extends Ee{static typeName="boolean";_inputElement;_containerClickListener=()=>this.handleClickFocusEvent();_containerFocusinListener=()=>this.handleClickFocusEvent();constructor(e,t,n){super(e,n),this._inputElement=document.createElement("input"),this._inputElement.type="checkbox",this._inputElement.checked=t??!0,this._inputElement.style.display="block",this.rootHtmlElement.appendChild(this._inputElement),it(()=>Ke(),this.rootHtmlElement),this.container.stateRequestEvent=()=>this.handleContainerStateRequestEvent(),this.rootHtmlElement.addEventListener("click",this._containerClickListener),this.rootHtmlElement.addEventListener("focusin",this._containerFocusinListener)}handleContainerStateRequestEvent(){return this._inputElement.checked}handleClickFocusEvent(){this.container.focus()}}class _ extends Ee{static typeName="color";static undefinedColor="MediumVioletRed";_paraElement;_inputElement;_containerClickListener=()=>this.handleClickFocusEvent();_containerFocusinListener=()=>this.handleClickFocusEvent();_beforeComponentReleaseEventListener=()=>this.handleBeforeComponentReleaseEvent();_inputChangeListener=()=>this.handleInputChangeEvent();_showEventListener=()=>this.handleShowEvent();constructor(e,t,n){super(e,n);let i;t===void 0?i=_.undefinedColor:typeof t!="string"?i="IndianRed":i=t,this._paraElement=document.createElement("p"),this._paraElement.style.textAlign="left",this._paraElement.style.color=i;const o=this.container.title;this._paraElement.innerText=(o??"unknown")+" component",this.rootHtmlElement.appendChild(this._paraElement),this._inputElement=document.createElement("input"),this._inputElement.type="text",this._inputElement.value=i,this._inputElement.style.display="block",this._inputElement.addEventListener("input",this._inputChangeListener,{passive:!0}),this.rootHtmlElement.appendChild(this._inputElement),this.container.stateRequestEvent=()=>this.handleContainerStateRequestEvent(),this.container.addEventListener("beforeComponentRelease",this._beforeComponentReleaseEventListener),this.container.addEventListener("show",this._showEventListener),this.rootHtmlElement.addEventListener("click",this._containerClickListener),this.rootHtmlElement.addEventListener("focusin",this._containerFocusinListener)}handleInputChangeEvent(){this._paraElement.style.color=this._inputElement.value}handleContainerStateRequestEvent(){const e=this._inputElement.value;if(e!==_.undefinedColor)return e}handleBeforeComponentReleaseEvent(){this._inputElement.removeEventListener("change",this._inputChangeListener),this.rootHtmlElement.removeChild(this._inputElement),this.rootHtmlElement.removeChild(this._paraElement),this.container.removeEventListener("show",this._showEventListener),this.container.removeEventListener("beforeComponentRelease",this._beforeComponentReleaseEventListener),this.rootHtmlElement.removeEventListener("click",this._containerClickListener),this.rootHtmlElement.removeEventListener("focusin",this._containerFocusinListener)}handleShowEvent(){this._paraElement.style.backgroundColor="purple",setTimeout(()=>{this._paraElement.style.backgroundColor=""},1e3)}handleClickFocusEvent(){this.container.focus()}}class j extends Ee{static typeName="event";_inputElement;_sendElement;_containerClickListener=()=>this.handleClickFocusEvent();_containerFocusinListener=()=>this.handleClickFocusEvent();constructor(e,t,n){super(e,n),this._inputElement=document.createElement("input"),this._inputElement.type="text",this._inputElement.style.display="block",this.rootHtmlElement.appendChild(this._inputElement),this._sendElement=document.createElement("button"),this._sendElement.innerText="SEND EVENT",this._sendElement.addEventListener("click",()=>{this.container.layoutManager.eventHub.emitUserBroadcast("foo",this._inputElement.value)}),this.rootHtmlElement.appendChild(this._sendElement);const i=(...o)=>{const s=document.createElement("span");s.innerText=`Received: ${o}`,this.rootHtmlElement.appendChild(s)};this.container.layoutManager.eventHub.on("userBroadcast",i),this.container.on("beforeComponentRelease",()=>{this.container.layoutManager.eventHub.off("userBroadcast",i)}),this.rootHtmlElement.addEventListener("click",this._containerClickListener),this.rootHtmlElement.addEventListener("focusin",this._containerFocusinListener)}handleClickFocusEvent(){this.container.focus()}}class H extends Ee{static undefinedTextValue="<undefined>";static typeName="text";_inputElement;_containerClickListener=()=>this.handleClickFocusEvent();_containerFocusinListener=()=>this.handleClickFocusEvent();constructor(e,t,n){super(e,n);let i;t===void 0?i=H.undefinedTextValue:je.isJson(t)?i=t.text:i="<Unexpect type>",this._inputElement=document.createElement("input"),this._inputElement.type="text",this._inputElement.value=i,this._inputElement.style.display="block",this.rootHtmlElement.appendChild(this._inputElement),this.container.stateRequestEvent=()=>this.handleContainerStateRequestEvent(),this.rootHtmlElement.addEventListener("click",this._containerClickListener),this.rootHtmlElement.addEventListener("focusin",this._containerFocusinListener)}handleContainerStateRequestEvent(){const e=this._inputElement.value;if(e!==H.undefinedTextValue)return{text:e}}handleClickFocusEvent(){this.container.focus()}}const Dt={settings:{popInOnClose:!0},root:{type:p.row,content:[{type:"component",title:"Solid",header:{show:"top"},isClosable:!0,reorderEnabled:!0,componentType:"solid view",size:"30%",componentState:{jsxIndex:1}},{title:"JS",header:{show:"top",popout:!1},type:"component",reorderEnabled:!0,componentType:"solid view",componentState:{jsxIndex:4}}]}},Ht={name:"miniRow",config:Dt},Nt={root:{type:p.stack,content:[{type:"component",title:"Golden",header:{show:"top"},componentType:_.typeName,size:"30%",componentState:"white"},{title:"Layout",header:{show:"top",popout:!1},type:"component",componentType:_.typeName,componentState:"green"}]}},Vt={name:"miniStack",config:Nt};p.row,_.typeName,_.typeName;const Ft={root:{type:p.component,title:"Layout",header:{show:"top",popout:!1},componentType:_.typeName,componentState:"green"}},Ut={name:"component",config:Ft},Wt={settings:{popoutWholeStack:!0,popInOnClose:!0},root:{type:"row",content:[{size:"80%",type:"column",content:[{title:"Fnts 100",header:{show:"bottom"},type:"component",componentType:_.typeName},{type:"row",content:[{type:"component",title:"Golden",header:{show:"right"},isClosable:!1,componentType:_.typeName,size:"30%",componentState:{bg:"golden_layout_spiral.png"}},{title:"Layout",header:{show:"left",popout:!1},type:"component",componentType:_.typeName,componentState:{bg:"golden_layout_text.png"}}]},{type:"stack",content:[{type:"component",title:"Acme, inc.",componentType:_.typeName,componentState:{companyName:"Stock X"}},{type:"component",title:"LexCorp plc.",componentType:_.typeName,componentState:{companyName:"Stock Y"}},{type:"component",title:"Springshield plc.",componentType:_.typeName,componentState:{companyName:"Stock Z"}}]}]},{size:"50%",type:"row",content:[{type:"stack",content:[{type:"component",title:"comp 1",componentType:_.typeName,componentState:{companyName:"Stock X"}},{type:"component",title:"comp 1",componentType:j.typeName,componentState:{companyName:"Event"}},{type:"component",title:"comp 2",componentType:_.typeName,componentState:{companyName:"Stock Y"}},{type:"component",title:"comp 3",componentType:_.typeName,componentState:{companyName:"Stock Z"}}]}]}]}},Ot={name:"standard",config:Wt},$t={settings:{responsiveMode:"always"},dimensions:{defaultMinItemWidth:"250px"},root:{type:"row",content:[{size:"30%",type:"column",content:[{title:"Fnts 100",type:"component",componentType:_.typeName},{type:"row",content:[{type:"component",title:"Golden",componentType:_.typeName,size:"30%",componentState:{bg:"golden_layout_spiral.png"}}]},{type:"stack",content:[{type:"component",title:"Acme, inc.",componentType:_.typeName,componentState:{companyName:"Stock X"}},{type:"component",title:"LexCorp plc.",componentType:_.typeName,componentState:{companyName:"Stock Y"}},{type:"component",title:"Springshield plc.",componentType:_.typeName,componentState:{companyName:"Stock Z"}}]}]},{size:"30%",title:"Layout",type:"component",componentType:_.typeName,componentState:{bg:"golden_layout_text.png"}},{size:"20%",type:"component",title:"Market",componentType:_.typeName,componentState:{className:"market-content",style:[".market-content label {","  margin-top: 10px","  display: block","  text-align: left","}",".market-content input {","  width: 250px","  border: 1px solid red","}"],html:['<label for="name">Name<label>','<input id="name" type="text"></input>']}},{size:"20%",type:"column",content:[{size:"20%",type:"component",title:"Performance",componentType:_.typeName},{size:"80%",type:"component",title:"Profile",componentType:_.typeName}]}]}},Gt={name:"responsive",config:$t},qt={settings:{tabOverlapAllowance:25,reorderOnTabMenuClick:!1,tabControlOffset:5},root:{type:"row",content:[{size:"30%",type:"column",content:[{title:"Fnts 100",type:"component",componentType:H.typeName},{type:"row",content:[{type:"component",title:"Golden",componentType:H.typeName,size:"30%",componentState:{text:"hello"}}]},{type:"stack",content:[{type:"component",title:"Acme, inc.",componentType:_.typeName,componentState:{companyName:"Stock X"}},{type:"component",title:"LexCorp plc.",componentType:_.typeName,componentState:{companyName:"Stock Y"}},{type:"component",title:"Springshield plc.",componentType:_.typeName,componentState:{companyName:"Stock Z"}}]}]},{size:"20%",type:"stack",content:[{type:"component",title:"Market",componentType:_.typeName},{type:"component",title:"Performance",componentType:_.typeName},{type:"component",title:"Trend",componentType:_.typeName},{type:"component",title:"Balance",componentType:_.typeName},{type:"component",title:"Budget",componentType:_.typeName},{type:"component",title:"Curve",componentType:_.typeName},{type:"component",title:"Standing",componentType:_.typeName},{type:"component",title:"Lasting",componentType:_.typeName,componentState:{bg:"golden_layout_spiral.png"}},{type:"component",title:"Profile",componentType:_.typeName}]},{size:"30%",title:"Layout",type:"component",componentType:Z.typeName,componentState:!0}]}},Zt={name:"tabDropdown",config:qt},jt={root:{type:p.row,content:[{type:"component",title:"Golden",header:{show:"top"},isClosable:!1,componentType:_.typeName,width:30,componentState:"gold"},{title:"Layout",header:{show:"top",popout:!1},type:"component",componentType:_.typeName,componentState:void 0}]}},Xt={name:"miniRow (WidthHeight)",config:jt},Yt={root:{type:p.stack,content:[{type:"component",title:"Golden",header:{show:"top"},componentType:_.typeName,width:30,componentState:"white"},{title:"Layout",header:{show:"top",popout:!1},type:"component",componentType:_.typeName,componentState:"green"}]}},Jt={name:"miniStack (WidthHeight)",config:Yt};p.row,_.typeName,_.typeName;const Kt={root:{type:p.component,title:"Layout",header:{show:"top",popout:!1},componentType:_.typeName,componentState:"green"}},Qt={name:"component (WidthHeight)",config:Kt},en={settings:{popoutWholeStack:!0,popInOnClose:!0},root:{type:"row",content:[{width:80,type:"column",content:[{title:"Fnts 100",header:{show:"bottom"},type:"component",componentType:_.typeName},{type:"row",content:[{type:"component",title:"Golden",header:{show:"right"},isClosable:!1,componentType:_.typeName,width:30,componentState:{bg:"golden_layout_spiral.png"}},{title:"Layout",header:{show:"left",popout:!1},type:"component",componentType:_.typeName,componentState:{bg:"golden_layout_text.png"}}]},{type:"stack",content:[{type:"component",title:"Acme, inc.",componentType:_.typeName,componentState:{companyName:"Stock X"}},{type:"component",title:"LexCorp plc.",componentType:_.typeName,componentState:{companyName:"Stock Y"}},{type:"component",title:"Springshield plc.",componentType:_.typeName,componentState:{companyName:"Stock Z"}}]}]},{width:50,type:"row",title:"test stack",content:[{type:"stack",title:"test row",content:[{type:"component",title:"comp 1",componentType:_.typeName,componentState:{companyName:"Stock X"}},{type:"component",title:"comp 1",componentType:j.typeName,componentState:{companyName:"Event"}},{type:"component",title:"comp 2",componentType:_.typeName,componentState:{companyName:"Stock Y"}},{type:"component",title:"comp 3",componentType:_.typeName,componentState:{companyName:"Stock Z"}}]}]}]}},tn={name:"standard (WidthHeight)",config:en},nn={settings:{responsiveMode:"always"},dimensions:{minItemWidth:250},root:{type:"row",content:[{width:30,type:"column",content:[{title:"Fnts 100",type:"component",componentType:_.typeName},{type:"row",content:[{type:"component",title:"Golden",componentType:_.typeName,width:30,componentState:{bg:"golden_layout_spiral.png"}}]},{type:"stack",content:[{type:"component",title:"Acme, inc.",componentType:_.typeName,componentState:{companyName:"Stock X"}},{type:"component",title:"LexCorp plc.",componentType:_.typeName,componentState:{companyName:"Stock Y"}},{type:"component",title:"Springshield plc.",componentType:_.typeName,componentState:{companyName:"Stock Z"}}]}]},{width:30,title:"Layout",type:"component",componentType:_.typeName,componentState:{bg:"golden_layout_text.png"}},{width:20,type:"component",title:"Market",componentType:_.typeName,componentState:{className:"market-content",style:[".market-content label {","  margin-top: 10px","  display: block","  text-align: left","}",".market-content input {","  width: 250px","  border: 1px solid red","}"],html:['<label for="name">Name<label>','<input id="name" type="text"></input>']}},{width:20,type:"column",content:[{height:20,type:"component",title:"Performance",componentType:_.typeName},{height:80,type:"component",title:"Profile",componentType:_.typeName}]}]}},on={name:"responsive (WidthHeight)",config:nn},sn={settings:{tabOverlapAllowance:25,reorderOnTabMenuClick:!1,tabControlOffset:5},root:{type:"row",content:[{width:30,type:"column",content:[{title:"Fnts 100",type:"component",componentType:H.typeName},{type:"row",content:[{type:"component",title:"Golden",componentType:H.typeName,width:30,componentState:{text:"hello"}}]},{type:"stack",content:[{type:"component",title:"Acme, inc.",componentType:_.typeName,componentState:{companyName:"Stock X"}},{type:"component",title:"LexCorp plc.",componentType:_.typeName,componentState:{companyName:"Stock Y"}},{type:"component",title:"Springshield plc.",componentType:_.typeName,componentState:{companyName:"Stock Z"}}]}]},{width:20,type:"stack",content:[{type:"component",title:"Market",componentType:_.typeName},{type:"component",title:"Performance",componentType:_.typeName},{type:"component",title:"Trend",componentType:_.typeName},{type:"component",title:"Balance",componentType:_.typeName},{type:"component",title:"Budget",componentType:_.typeName},{type:"component",title:"Curve",componentType:_.typeName},{type:"component",title:"Standing",componentType:_.typeName},{type:"component",title:"Lasting",componentType:_.typeName,componentState:{bg:"golden_layout_spiral.png"}},{type:"component",title:"Profile",componentType:_.typeName}]},{width:30,title:"Layout",type:"component",componentType:Z.typeName,componentState:!0}]}},rn={name:"tabDropdown (WidthHeight)",config:sn},tt={allComponents:[Ht,Vt,Ut,Gt,Ot,Zt,Xt,Jt,Qt,on,tn,rn]};var an=V("<h1>SolidGoldenView Not Found"),ln=V("<p>Current Index: <!$><!/>"),dn=V("<p>Max Index: <!$><!/>"),cn=V("<p>State: <!$><!/>"),hn=V("<p>ctxcnt: cnt=<!$><!/>");const un=r=>{const e=Je();return ve(ot,{get when(){return r.jsxComponents[r.currentIndex]},get fallback(){return[B(an),(()=>{var t=B(ln),n=t.firstChild,i=n.nextSibling,[o,s]=X(i.nextSibling);return Y(t,()=>r.currentIndex,o,s),t})(),(()=>{var t=B(dn),n=t.firstChild,i=n.nextSibling,[o,s]=X(i.nextSibling);return Y(t,()=>r.maxIndex,o,s),t})(),(()=>{var t=B(cn),n=t.firstChild,i=n.nextSibling,[o,s]=X(i.nextSibling);return Y(t,()=>JSON.stringify(r.state),o,s),t})(),(()=>{var t=B(hn),n=t.firstChild,i=n.nextSibling,[o,s]=X(i.nextSibling);return Y(t,()=>e?.ctx.increments.val(),o,s),t})()]},get children(){return mt(()=>typeof r.jsxComponents[r.currentIndex]=="function")()?r.jsxComponents[r.currentIndex]():r.jsxComponents[r.currentIndex]}})},[Ce,Ze]=Ye({});class mn{constructor(){}jsxComponents=[];static defaultOptions={typeName:"solidgolden"};create(e){if(!e||typeof e!="string")throw new Error("Invalid typeName");const t=Ce[e];if(t)return new t;const n={typeName:e},i=this.jsxComponents,o=class xe extends Ee{static typeName=n.typeName;static jsxCmps=[];_containerClickListener=()=>this.handleClickFocusEvent();_containerFocusinListener=()=>this.handleClickFocusEvent();state;constructor(a,l,d){super(a,d),this.state=l,xe.jsxCmps=i,console.log("[SJSWrapper] root html",this.rootHtmlElement),it(()=>un({currentIndex:l.jsxIndex,maxIndex:xe.jsxCmps.length,jsxComponents:xe.jsxCmps,state:l}),this.rootHtmlElement),this.container.stateRequestEvent=()=>this.handleContainerStateRequestEvent(),this.rootHtmlElement.addEventListener("click",this._containerClickListener),this.rootHtmlElement.addEventListener("focusin",this._containerFocusinListener)}handleContainerStateRequestEvent(){return this.state}handleClickFocusEvent(){this.container.focus()}updateJsxComponents(a){xe.jsxCmps=a}};return Ze({...Ce,[e]:o}),o}static register(e,t){Ze({...Ce,[e]:t})}static unregister(e){const t=Ce;delete t[e],Ze(t)}setJsxComponents(e){console.log("[Factory] Set JSX",e),this.jsxComponents=e,Object.keys(Ce()).forEach(t=>{Ce()[t].prototype.updateJsxComponents(e)})}}class pn{_layoutElement;_controlsElement;_goldenLayout;_registerComponentTypesButton;_registerComponentTypesButtonClickListener=()=>this.registerComponentTypes();_registerAllRadio;_registerColorEventRadio;_registerComponentTypesAsVirtualButton;_registerComponentTypesAsVirtualButtonClickListener=()=>this.registerComponentTypesAsVirtual();_registerAllAsVirtualRadio;_registerTextBooleanAsVirtualRadio;_registeredComponentTypesForAddSelect;_registeredComponentTypesForAddSelectChangeListener=()=>this.handleRegisteredComponentTypesForAddSelectChange();_eventBindingVirtualRadio;_eventBindingVirtualRadioClickListener=()=>this.handleEventBindingVirtualRadioClick();_eventBindingEmbeddedRadio;_eventBindingEmbeddedRadioClickListener=()=>this.handleEventBindingEmbeddedRadioClick();_clearButton;_clearButtonClickListener=()=>this.handleClearButtonClick();_addComponentButton;_addComponentButtonClickListener=()=>this.handleAddComponentButtonClick();_layoutSelect;_layoutSelectChangeListener=()=>this.handleLayoutSelectChange();_loadLayoutButton;_loadLayoutButtonClickListener=()=>this.handleLoadLayoutButtonClick();_loadComponentAsRootButton;_loadComponentAsRootClickListener=()=>this.handleLoadComponentAsRootButtonClick();_registeredComponentTypesForReplaceSelect;_registeredComponentTypesForReplaceSelectChangeListener=()=>this.handleRegisteredComponentTypesForReplaceSelectChange();_replaceComponentButton;_replaceComponentButtonClickListener=()=>this.handleReplaceComponentButtonClick();_saveLayoutButton;_saveLayoutButtonClickListener=()=>this.handleSaveLayoutButtonClick();_reloadSavedLayoutButton;_reloadSavedLayoutButtonClickListener=()=>this.handleReloadSavedLayoutButtonClick();_lastVirtualRectingCountSpan;_bubbleClickCountSpan;_captureClickCountSpan;_stackHeaderClickedDiv;_stackHeaderClickedItemCountSpan;_boundComponentMap=new Map;_bubbleClickCount=0;_captureClickCount=0;_lastVirtualRectingCount=0;_allComponentsRegistered=!1;_savedLayout;_useVirtualEventBinding=!0;_goldenLayoutBoundingClientRect=new DOMRect;_globalBubbleClickListener=()=>this.handleGlobalBubbleClickEvent();_globalCaptureClickListener=()=>this.handleGlobalCaptureClickEvent();_bindComponentEventListener=(e,t)=>this.handleBindComponentEvent(e,t);_unbindComponentEventListener=e=>this.handleUnbindComponentEvent(e);jsxComponents=[];jsxCmpCurrentIndex=0;solidGoldenFactory=new mn;solidGoldenComponentRef=this.solidGoldenFactory.create("solid view");componentContainers;componentContainersCb;constructor(e){this.jsxComponents=e,console.log("[App] JSXes",this.jsxComponents),this.solidGoldenFactory.setJsxComponents(this.jsxComponents),this.solidGoldenComponentRef=this.solidGoldenFactory.create("solid view");const t=document.querySelector("#controls");if(t===null)throw new Error("controlsElement not found");this._controlsElement=t;const n=document.querySelector("#layoutContainer");if(n===null)throw new Error("layoutContainerElement not found");this._layoutElement=n,this._goldenLayout=new Bt(this._layoutElement,this._bindComponentEventListener,this._unbindComponentEventListener),this._goldenLayout.resizeWithContainerAutomatically=!0,this._goldenLayout.beforeResizingEvent=ee=>this.handleBeforeResizingEvent(ee),this._goldenLayout.addEventListener("stackHeaderClick",ee=>this.handleStackHeaderClick(ee));const i=document.querySelector("#registerNotVirtualButton");if(i===null)throw new Error("Could not find RegisterNotVirtualButton");this._registerComponentTypesButton=i,this._registerComponentTypesButton.addEventListener("click",this._registerComponentTypesButtonClickListener,{passive:!0});const o=document.querySelector("#registerNotVirtualAllRadio");if(o===null)throw new Error("Could not find RegisterNotVirtualAllRadio");this._registerAllRadio=o;const s=document.querySelector("#registerNotVirtualColorEventRadio");if(s===null)throw new Error("Could not find RegisterNotVirtualColorEventRadio");this._registerColorEventRadio=s;const a=document.querySelector("#registerVirtualButton");if(a===null)throw new Error("Could not find RegisterVirtualButton");this._registerComponentTypesAsVirtualButton=a,this._registerComponentTypesAsVirtualButton.addEventListener("click",this._registerComponentTypesAsVirtualButtonClickListener,{passive:!0});const l=document.querySelector("#registerVirtualAllRadio");if(l===null)throw new Error("Could not find RegisterVirtualAllRadio");this._registerAllAsVirtualRadio=l;const d=document.querySelector("#registerVirtualTextBooleanRadio");if(d===null)throw new Error("Could not find RegisterVirtualTextBooleanRadio");this._registerTextBooleanAsVirtualRadio=d;const c=document.querySelector("#eventBindingVirtualRadio");if(c===null)throw new Error("Could not find EventBindingVirtualRadio");this._eventBindingVirtualRadio=c,this._eventBindingVirtualRadio.addEventListener("click",this._eventBindingVirtualRadioClickListener,{passive:!0});const u=document.querySelector("#eventBindingEmbeddedRadio");if(u===null)throw new Error("Could not find EventBindingEmbeddedRadio");this._eventBindingEmbeddedRadio=u,this._eventBindingEmbeddedRadio.addEventListener("click",this._eventBindingEmbeddedRadioClickListener,{passive:!0}),this._eventBindingVirtualRadio.checked=this._useVirtualEventBinding;const m=document.querySelector("#clearButton");if(m===null)throw new Error("Could not find ClearButton");this._clearButton=m,this._clearButton.addEventListener("click",this._clearButtonClickListener,{passive:!0});const h=document.querySelector("#registeredComponentTypesForAddSelect");if(h===null)throw new Error;this._registeredComponentTypesForAddSelect=h,this._registeredComponentTypesForAddSelect.addEventListener("change",this._registeredComponentTypesForAddSelectChangeListener,{passive:!0});const f=document.querySelector("#addComponentButton");if(f===null)throw new Error("Could not find addComponentButton");this._addComponentButton=f,this._addComponentButton.addEventListener("click",this._addComponentButtonClickListener,{passive:!0});const g=document.querySelector("#addComponentByDragButton");if(g===null)throw new Error("Could not find addComponentByDragButton");if(this._goldenLayout.newDragSource(g,()=>this.getDragComponentTypeAndState())===void 0)throw new Error("addComponentDragSource undefined");const b=document.querySelector("#layoutSelect");if(b===null)throw new Error;this._layoutSelect=b,this._layoutSelect.addEventListener("change",this._layoutSelectChangeListener,{passive:!0});const x=document.querySelector("#loadLayoutButton");if(x===null)throw new Error("Could not find loadLayoutButton");this._loadLayoutButton=x,this._loadLayoutButton.addEventListener("click",this._loadLayoutButtonClickListener,{passive:!0});const A=document.querySelector("#loadComponentAsRootButton");if(A===null)throw new Error("Could not find loadComponentAsRootButton");this._loadComponentAsRootButton=A,this._loadComponentAsRootButton.addEventListener("click",this._loadComponentAsRootClickListener,{passive:!0});const P=document.querySelector("#registeredComponentTypesForReplaceSelect");if(P===null)throw new Error;this._registeredComponentTypesForReplaceSelect=P,this._registeredComponentTypesForReplaceSelect.addEventListener("change",this._registeredComponentTypesForReplaceSelectChangeListener,{passive:!0});const k=document.querySelector("#replaceComponentButton");if(k===null)throw new Error("Could not find replaceComponentButton");this._replaceComponentButton=k,this._replaceComponentButton.addEventListener("click",this._replaceComponentButtonClickListener,{passive:!0});const F=document.querySelector("#saveLayoutButton");if(F===null)throw new Error("Could not find saveLayoutButton");this._saveLayoutButton=F,this._saveLayoutButton.addEventListener("click",this._saveLayoutButtonClickListener,{passive:!0});const M=document.querySelector("#reloadSavedLayoutButton");if(M===null)throw new Error("Could not find reloadSavedLayoutButton");this._reloadSavedLayoutButton=M,this._reloadSavedLayoutButton.disabled=!0,this._reloadSavedLayoutButton.addEventListener("click",this._reloadSavedLayoutButtonClickListener,{passive:!0});const pe=document.querySelector("#lastVirtualRectingCountSpan");if(pe===null)throw new Error("Could not find LastVirtualRectingCountSpan");this._lastVirtualRectingCountSpan=pe,this._lastVirtualRectingCountSpan.innerText=this._lastVirtualRectingCount.toString();const T=document.querySelector("#bubbleClickCountSpan");if(T===null)throw new Error("Could not find bubbleClickCountSpan");this._bubbleClickCountSpan=T,this._bubbleClickCountSpan.innerText=this._bubbleClickCount.toString();const fe=document.querySelector("#captureClickCountSpan");if(fe===null)throw new Error("Could not find captureClickCountSpan");this._captureClickCountSpan=fe,this._captureClickCountSpan.innerText=this._captureClickCount.toString();const _e=document.querySelector("#stackHeaderClickedDiv");if(_e===null)throw new Error("Could not find stackHeaderClickedDiv");this._stackHeaderClickedDiv=_e,this._stackHeaderClickedDiv.style.display="none";const ge=document.querySelector("#stackHeaderClickedItemCountSpan");if(ge===null)throw new Error("Could not find stackHeaderClickedItemCountSpan");this._stackHeaderClickedItemCountSpan=ge,this._goldenLayout.isSubWindow&&(this._controlsElement.style.display="none",this._goldenLayout.checkAddDefaultPopinButton()),globalThis.addEventListener("click",this._globalBubbleClickListener,{passive:!0}),globalThis.addEventListener("click",this._globalCaptureClickListener,{capture:!0,passive:!0})}start(){this.loadComponentTypesForAddSelect(),this.loadComponentTypesForReplaceSelect(),this.loadLayoutSelect()}createComponent(e,t,n,i){switch(console.log("[GL] Masuk sini",e,t,n,i),t){case _.typeName:return new _(e,n,i);case H.typeName:return new H(e,n,i);case Z.typeName:return new Z(e,n,i);case j.typeName:return new j(e,n,i);case this.solidGoldenComponentRef.typeName:return console.log("[GL] Case Sini"),this.goldenInformComponentCreation(e),new this.solidGoldenComponentRef(e,n,i);default:throw new Error("createComponent: Unexpected componentTypeName: "+t)}}handleBindComponentEvent(e,t){console.log("[GL] Bind Listener",e,t);const n=Q.resolveComponentTypeName(t);if(n===void 0)throw new Error("handleBindComponentEvent: Undefined componentTypeName");const i=this.createComponent(e,n,t.componentState,this._useVirtualEventBinding);if(this._boundComponentMap.set(e,i),this._useVirtualEventBinding){const o=i.rootHtmlElement;return this._layoutElement.appendChild(o),e.virtualRectingRequiredEvent=(s,a,l)=>this.handleContainerVirtualRectingRequiredEvent(s,a,l),e.virtualVisibilityChangeRequiredEvent=(s,a)=>this.handleContainerVirtualVisibilityChangeRequiredEvent(s,a),e.virtualZIndexChangeRequiredEvent=(s,a,l)=>this.handleContainerVirtualZIndexChangeRequiredEvent(s,a,l),{component:i,virtual:!0}}else return{component:i,virtual:!1}}handleUnbindComponentEvent(e){const t=this._boundComponentMap.get(e);if(t===void 0)throw new Error("handleUnbindComponentEvent: Component not found");const n=t.rootHtmlElement;if(n===void 0)throw new Error("handleUnbindComponentEvent: Component does not have a root HTML element");e.virtual&&this._layoutElement.removeChild(n),this._boundComponentMap.delete(e)}handleBeforeResizingEvent(e){this._goldenLayoutBoundingClientRect=this._layoutElement.getBoundingClientRect(),this._lastVirtualRectingCount=e,this._lastVirtualRectingCountSpan.innerText=this._lastVirtualRectingCount.toString()}handleContainerVirtualRectingRequiredEvent(e,t,n){const i=this._boundComponentMap.get(e);if(i===void 0)throw new Error("handleContainerVirtualRectingRequiredEvent: Component not found");const o=i.rootHtmlElement;if(o===void 0)throw new Error("handleContainerVirtualRectingRequiredEvent: Component does not have a root HTML element");const s=e.element.getBoundingClientRect(),a=s.left-this._goldenLayoutBoundingClientRect.left;o.style.left=this.numberToPixels(a);const l=s.top-this._goldenLayoutBoundingClientRect.top;o.style.top=this.numberToPixels(l),o.style.width=this.numberToPixels(t),o.style.height=this.numberToPixels(n)}handleContainerVirtualVisibilityChangeRequiredEvent(e,t){const n=this._boundComponentMap.get(e);if(n===void 0)throw new Error("handleContainerVisibilityChangeRequiredEvent: Component not found");const i=n.rootHtmlElement;if(i===void 0)throw new Error("handleContainerVisibilityChangeRequiredEvent: Component does not have a root HTML element");t?i.style.display="":i.style.display="none"}handleContainerVirtualZIndexChangeRequiredEvent(e,t,n){const i=this._boundComponentMap.get(e);if(i===void 0)throw new Error("handleContainerVirtualZIndexChangeRequiredEvent: Component not found");const o=i.rootHtmlElement;if(o===void 0)throw new Error("handleContainerVirtualZIndexChangeRequiredEvent: Component does not have a root HTML element");o.style.zIndex=n}handleGlobalBubbleClickEvent(){this._bubbleClickCount++,this._bubbleClickCountSpan.innerText=this._bubbleClickCount.toString()}handleGlobalCaptureClickEvent(){this._captureClickCount++,this._captureClickCountSpan.innerText=this._captureClickCount.toString()}registerComponentTypes(){this._allComponentsRegistered||(this._goldenLayout.registerComponentConstructor(_.typeName,_),this._goldenLayout.registerComponentConstructor(j.typeName,j),this._registerComponentTypesButton.disabled=!0,this._registerAllRadio.disabled=!0,this._registerColorEventRadio.disabled=!0,this._registerAllRadio.checked?(this._goldenLayout.registerComponentConstructor(H.typeName,H),this._goldenLayout.registerComponentConstructor(Z.typeName,Z),this._allComponentsRegistered=!0,this._registerComponentTypesAsVirtualButton.disabled=!0,this._registerTextBooleanAsVirtualRadio.disabled=!0):this._registerTextBooleanAsVirtualRadio.checked=!0,this._registerAllAsVirtualRadio.disabled=!0)}registerComponentTypesAsVirtual(){this._allComponentsRegistered||(this._goldenLayout.registerComponentConstructor(H.typeName,H,!0),this._goldenLayout.registerComponentConstructor(Z.typeName,Z,!0),this._registerComponentTypesAsVirtualButton.disabled=!0,this._registerAllAsVirtualRadio.disabled=!0,this._registerTextBooleanAsVirtualRadio.disabled=!0,this._registerAllAsVirtualRadio.checked?(this._goldenLayout.registerComponentConstructor(_.typeName,_,!0),this._goldenLayout.registerComponentConstructor(j.typeName,j,!0),this._allComponentsRegistered=!0,this._registerComponentTypesButton.disabled=!0,this._registerColorEventRadio.disabled=!0):this._registerColorEventRadio.checked=!0,this._registerAllRadio.disabled=!0)}handleEventBindingVirtualRadioClick(){this._goldenLayout.clear(),this._useVirtualEventBinding=!0}handleEventBindingEmbeddedRadioClick(){this._goldenLayout.clear(),this._useVirtualEventBinding=!1}handleRegisteredComponentTypesForAddSelectChange(){}handleLayoutSelectChange(){}handleClearButtonClick(){this._goldenLayout.clear()}handleStackHeaderClick(e){const n=e.target.contentItems.length;this._stackHeaderClickedItemCountSpan.innerText=n.toString(),this._stackHeaderClickedDiv.style.display="",setTimeout(()=>{this._stackHeaderClickedDiv.style.display="none"},1e3)}handleAddComponentButtonClick(){const e=this._registeredComponentTypesForAddSelect.value;this._goldenLayout.addComponent(e)}getDragComponentTypeAndState(){return{type:"component",componentType:this._registeredComponentTypesForAddSelect.value}}handleLoadLayoutButtonClick(){const e=this._layoutSelect.value,n=tt.allComponents.find(i=>i.name===e);if(n===void 0)throw new Error("handleLayoutSelectChange");this._goldenLayout.loadLayout(n.config)}handleLoadComponentAsRootButtonClick(){const e={type:"component",componentType:_.typeName,componentState:"yellow"};this._goldenLayout.loadComponentAsRoot(e)}handleRegisteredComponentTypesForReplaceSelectChange(){}handleReplaceComponentButtonClick(){const t={componentType:this._registeredComponentTypesForReplaceSelect.value,type:"component"},n=this._goldenLayout.rootItem;if(n!==void 0){const i=[n];this.replaceComponentRecursively(i,t)}}handleSaveLayoutButtonClick(){this._savedLayout=this._goldenLayout.saveLayout(),this._reloadSavedLayoutButton.disabled=!1}handleReloadSavedLayoutButtonClick(){if(this._savedLayout===void 0)throw new Error("No saved layout");{const e=U.fromResolved(this._savedLayout);this._goldenLayout.loadLayout(e)}}getAllComponentTypeNames(){const e=[];return e.push(_.typeName),e.push(H.typeName),e.push(Z.typeName),e.push(j.typeName),e.push(this.solidGoldenComponentRef.typeName),e}loadComponentTypesForAddSelect(){this._registeredComponentTypesForAddSelect.options.length=0;const e=this.getAllComponentTypeNames();for(const t of e){const n=new Option(t);this._registeredComponentTypesForAddSelect.options.add(n)}}loadComponentTypesForReplaceSelect(){this._registeredComponentTypesForReplaceSelect.options.length=0;const e=this.getAllComponentTypeNames();for(const t of e){const n=new Option(t);this._registeredComponentTypesForReplaceSelect.options.add(n)}}loadLayoutSelect(){this._layoutSelect.options.length=0;const e=tt.allComponents;for(const t of e){const n=new Option(t.name);this._layoutSelect.options.add(n)}}replaceComponentRecursively(e,t){for(const n of e)if(N.isComponentItem(n)){const i=n.container;i.componentType===_.typeName&&i.replaceComponent(t)}else this.replaceComponentRecursively(n.contentItems,t)}numberToPixels(e){return e.toString(10)+"px"}goldenLoadLayout(e){this._goldenLayout.loadLayout(e)}goldenRegisterComponent(e,t){this._goldenLayout.registerComponentConstructor(e,t)}goldenAppendView(e,t){this.jsxCmpCurrentIndex=e,this._goldenLayout.addComponent(this.solidGoldenComponentRef.typeName,{jsxIndex:e},t||void 0)}goldenListenEvents(e,t){this._goldenLayout.on(e,t)}goldenRegisterEventHub(e,t,n){(n||this._goldenLayout).eventHub.on(e,t),console.log("Event Registered",n)}goldenEmitEventHub(e,t,n){(n||this._goldenLayout).eventHub.emit(e,t)}goldenInformComponentCreation(e){this.componentContainersCb?this.componentContainersCb(e):console.log("Unable to inform component creation. Perhaps is popout?",e)}goldenRegisterComponentCreatioinCb(e){this.componentContainersCb=e}}var fn=V("<div>Hallo Dunia"),_n=V("<h2>Apa Kabar <!$><!/>"),gn=V("<button type=button>Tambah View 1 cnt=<!$><!/>"),Cn=V("<button type=button>Tambah View 2"),yn=V("<button type=button>Tambah View 3"),vn=V("<span>Component moved into portal"),bn=V('<section id=bodySection><section id=controls><section id=registerSection><section id=registerNotVirtualSection><button id=registerNotVirtualButton class=control>Register Component Types</button><section id=registerNotVirtualRadioSection class=radioLine><section class=labelledRadio><input id=registerNotVirtualAllRadio class=control type=radio name=registerNotVirtualRadio><label for=registerNotVirtualAllRadio>All</label></section><section class=labelledRadio><input id=registerNotVirtualColorEventRadio class=control type=radio name=registerNotVirtualRadio checked><label for=registerVirtualColorEventRadio>Color, Event</label></section></section></section><section id=registerVirtualSection><button id=registerVirtualButton class=control>Register Component Types As Virtual</button><section id=registerVirtualRadioSection class=radioLine><section class=labelledRadio><input id=registerVirtualAllRadio type=radio name=registerVirtualRadio><label for=registerVirtualAllRadio>All</label></section><section class=labelledRadio><input id=registerVirtualTextBooleanRadio type=radio name=registerVirtualRadio checked><label for=registerVirtualTextBooleanRadio>Text, Boolean</label></section></section></section></section><section id=eventBindingSection><span id=eventBindingSpan title="Layout will be cleared">Event Binding:</span><section id=eventBindingRadios class=radioLine><section class=labelledRadio><input id=eventBindingVirtualRadio class=control type=radio name=eventBindingRadio title="Layout will be cleared"><label for=eventBindingVirtualRadio>Virtual</label></section><section class=labelledRadio><input id=eventBindingEmbeddedRadio class=control type=radio name=eventBindingRadio title="Layout will be cleared"><label for=eventBindingEmbeddedRadio>Embedded</label></section></section></section><section id=clearSection><button id=clearButton class=control>Clear</button></section><section id=predefinedLayoutsSection><select id=layoutSelect class=control></select><button id=loadLayoutButton class=control>Load Layout</button></section><section id=saveAndReloadLayoutSection><button id=saveLayoutButton class=control>Save Layout</button><button id=reloadSavedLayoutButton class=control>Reload saved Layout</button></section><section id=addComponentSection><select id=registeredComponentTypesForAddSelect class=control></select><button id=addComponentByDragButton class=control>D</button><button id=addComponentButton class=control>Add Component</button></section><section id=rootComponentSection><button id=loadComponentAsRootButton class=control>Load Component as Root</button></section><section id=replaceComponentSection><select id=registeredComponentTypesForReplaceSelect class=control></select><button id=replaceComponentButton class=control>Replace Color Component with</button></section><section id=lastVirtualRectingCountSection><span>Last virtual recting count</span><span id=lastVirtualRectingCountSpan></span></section><section id=clickCount><span>Click count: Capture: </span><span id=captureClickCountSpan></span><span> Bubble: </span><span id=bubbleClickCountSpan></span></section><section id=stackHeaderClick><span>Stack Header: </span><div id=stackHeaderClickedDiv><span>Clicked: </span><span id=stackHeaderClickedItemCountSpan></span></div></section></section><section id=layoutContainer>');const wn=()=>{const[r,e]=Ye(),t=Ee;let n;const i=Je();pt(()=>{console.log("Loaded",t),o()});const o=()=>{const a=window.location.search.includes("gl-window");n=new pn([()=>B(fn),(()=>{var l=B(_n),d=l.firstChild,c=d.nextSibling,[u,m]=X(c.nextSibling);return Y(l,()=>i?.ctx.increments.val(),u,m),l})(),()=>ve(Ke,{})]),window.goldenLayoutApiTestApp=n,n.start(),n.goldenListenEvents("windowOpened",l=>{console.log("[GoldLayout] Event Popout Received",l),n.goldenRegisterEventHub("tabrestore",(c,u)=>{console.log("[EV] triggered child side!",c,u),l.popIn()},l.getGlInstance())}),n.goldenListenEvents("windowClosed",l=>{console.log("[GoldLayout] Event Received",l)}),n.goldenRegisterComponentCreatioinCb(l=>{console.log("[GLV] Component Created",l.element),e(l.element)}),a&&window.addEventListener("pagehide",l=>{n.goldenEmitEventHub("tabrestore","Restore_"+window.location.search)})},s=(a,l)=>()=>{n.goldenAppendView(a,l)};return[(()=>{var a=B(gn),l=a.firstChild,d=l.nextSibling,[c,u]=X(d.nextSibling);return qe(a,"click",s(0,"View 1"),!0),Y(a,()=>i?.ctx.increments.val(),c,u),Ne(),a})(),(()=>{var a=B(Cn);return qe(a,"click",s(1,"View 2"),!0),Ne(),a})(),(()=>{var a=B(yn);return qe(a,"click",s(2,"View Brohh"),!0),Ne(),a})(),ve(ot,{get when(){return r()},get children(){return ve(ft,{get mount(){return r()},ref:a=>a.style.backgroundColor="#AAA",get children(){return B(vn)}})}}),B(bn)]};nt(["click"]);var Sn=V("<main><h1>Example Golden Layout</h1><!$><!/><!$><!/>");function Tn(){return(()=>{var r=B(Sn),e=r.firstChild,t=e.nextSibling,[n,i]=X(t.nextSibling),o=n.nextSibling,[s,a]=X(o.nextSibling);return Y(r,ve(Ke,{}),n,i),Y(r,ve(wn,{}),s,a),r})()}export{Tn as default};
